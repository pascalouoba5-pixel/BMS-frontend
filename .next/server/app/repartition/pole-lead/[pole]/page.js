(()=>{var e={};e.id=371,e.ids=[371],e.modules={3020:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Desktop\\\\Projet du pole Informatique\\\\Dossier d\xe9veloppement\\\\BMS 3\\\\BMS_06_08_25\\\\BMS_06_08_25\\\\BMS\\\\frontend\\\\components\\\\ProtectedRoute.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\components\\ProtectedRoute.tsx","default")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},25290:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var r=s(28625),a=s(64996),i=s(90078);function l({offres:e,loading:t,poleName:s,onViewOffre:i,onDeleteOffre:l,onDownloadTDR:n,searchTerm:o="",sortBy:d="dateDepot",sortOrder:c="desc",onSort:x,selectedModalite:m="all",className:p=""}){let[u,h]=(0,a.useState)([]),f=e=>{switch(e){case"Strat\xe9gique":return"bg-purple-100 text-purple-800";case"Priorit\xe9 haute":return"bg-red-100 text-red-800";case"Opportunit\xe9 interm\xe9diaire":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},g=e=>{switch(e){case"gagn\xe9":return"bg-green-100 text-green-800";case"d\xe9pos\xe9e":return"bg-blue-100 text-blue-800";case"mont\xe9e":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},b=e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},j=e=>e&&0!==e.length?e.join(", "):"Non sp\xe9cifi\xe9",y=e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Non sp\xe9cifi\xe9e",N=e=>e?e.replace("€"," €"):"Non sp\xe9cifi\xe9",v=e=>{x&&x(e)};return t?(0,r.jsx)("div",{className:`bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden ${p}`,children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,r.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"},t))})]})})}):(0,r.jsxs)("div",{className:`bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden ${p}`,children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-building-line text-blue-600 mr-2"}),"Offres du ",s]}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:[u.length," offre",u.length>1?"s":""," trouv\xe9e",u.length>1?"s":""]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-refresh-line"}),"Rafra\xeechir"]})})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("intituleOffre"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-file-text-line"}),"Intitul\xe9 Offre","intituleOffre"===d&&(0,r.jsx)("i",{className:`ri-arrow-${"asc"===c?"up":"down"}-line`})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("bailleur"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-building-line"}),"Bailleur","bailleur"===d&&(0,r.jsx)("i",{className:`ri-arrow-${"asc"===c?"up":"down"}-line`})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-map-pin-line"}),"Pays"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-money-dollar-circle-line"}),"Montant"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("priorite"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-flag-line"}),"Priorit\xe9","priorite"===d&&(0,r.jsx)("i",{className:`ri-arrow-${"asc"===c?"up":"down"}-line`})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("modalite"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line"}),"Modalit\xe9","modalite"===d&&(0,r.jsx)("i",{className:`ri-arrow-${"asc"===c?"up":"down"}-line`})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>v("dateDepot"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-calendar-line"}),"Date D\xe9p\xf4t","dateDepot"===d&&(0,r.jsx)("i",{className:`ri-arrow-${"asc"===c?"up":"down"}-line`})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-file-download-line"}),"TDR"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line"}),"Actions"]})})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===u.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:9,className:"px-6 py-12 text-center text-gray-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"Aucune offre trouv\xe9e"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:o?"Aucune offre ne correspond \xe0 votre recherche.":`Aucune offre attribu\xe9e au ${s}.`})]})})}):u.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 max-w-xs truncate",children:e.intituleOffre||e.titre||"Sans titre"}),e.statut&&(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full border mt-1 ${b(e.statut)}`,children:"approuv\xe9e"===e.statut?"Approuv\xe9e":"rejet\xe9e"===e.statut?"Rejet\xe9e":"en_attente"===e.statut?"En attente":"Brouillon"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:j(e.pays)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:N(e.montant||e.budget)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.priorite?(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${f(e.priorite)}`,children:e.priorite}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non d\xe9finie"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.modalite?(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${g(e.modalite)}`,children:e.modalite}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non sp\xe9cifi\xe9e"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:y(e.dateDepot)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.tdrFile||e.lienTDR?(0,r.jsxs)("button",{onClick:()=>n&&n(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-download-line"}),"T\xe9l\xe9charger"]}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non disponible"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[i&&(0,r.jsxs)("button",{onClick:()=>i(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-eye-line"}),"Voir"]}),l&&(0,r.jsxs)("button",{onClick:()=>l(e),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-close-line"}),"Annuler"]})]})})]},e.id))})]})})]})}var n=s(49421),o=s(47403),d=s(81446);function c({offreId:e,onFichiersUpdate:t}){let[s,i]=(0,a.useState)([]),[l,n]=(0,a.useState)(!1),[o,c]=(0,a.useState)(!1),[x,m]=(0,a.useState)(null),[p,u]=(0,a.useState)(""),[h,f]=(0,a.useState)("1.0"),[g,b]=(0,a.useState)(!1),{token:j}=(0,d.A)(),y=async()=>{if(j){n(!0);try{let t=await fetch(`/api/fichiers-tdr/offre/${e}`,{headers:{Authorization:`Bearer ${j}`}});if(t.ok){let e=await t.json();i(e.fichiers||[])}else console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers TDR")}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers TDR:",e)}finally{n(!1)}}},N=async()=>{if(x&&j){c(!0);try{let s=new FormData;s.append("fichier",x),s.append("description",p),s.append("version",h);let r=await fetch(`/api/fichiers-tdr/upload/${e}`,{method:"POST",headers:{Authorization:`Bearer ${j}`},body:s});if(r.ok)await r.json(),alert("Fichier TDR upload\xe9 avec succ\xe8s !"),m(null),u(""),f("1.0"),b(!1),y(),t&&t();else{let e=await r.json();alert(`Erreur lors de l'upload: ${e.error}`)}}catch(e){console.error("Erreur lors de l'upload:",e),alert("Erreur lors de l'upload du fichier")}finally{c(!1)}}},v=async(e,t)=>{if(j)try{let s=await fetch(`/api/fichiers-tdr/download/${e}`,{headers:{Authorization:`Bearer ${j}`}});if(s.ok){let e=await s.blob(),r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}else alert("Erreur lors du t\xe9l\xe9chargement du fichier")}catch(e){console.error("Erreur lors du t\xe9l\xe9chargement:",e),alert("Erreur lors du t\xe9l\xe9chargement du fichier")}},w=async e=>{if(j&&confirm("\xcates-vous s\xfbr de vouloir supprimer ce fichier TDR ?"))try{(await fetch(`/api/fichiers-tdr/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${j}`}})).ok?(alert("Fichier TDR supprim\xe9 avec succ\xe8s !"),y(),t&&t()):alert("Erreur lors de la suppression du fichier")}catch(e){console.error("Erreur lors de la suppression:",e),alert("Erreur lors de la suppression du fichier")}},D=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},C=e=>e.includes("pdf")?"ri-file-pdf-line text-red-500":e.includes("word")?"ri-file-word-line text-blue-500":e.includes("excel")?"ri-file-excel-line text-green-500":"ri-file-line text-gray-500";return l?(0,r.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Chargement des fichiers TDR..."})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line text-blue-600 mr-2"}),"Fichiers TDR (",s.length,")"]}),(0,r.jsxs)("button",{onClick:()=>b(!g),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-upload-line"}),g?"Masquer":"Ajouter un fichier"]})]}),g&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier TDR *"}),(0,r.jsx)("input",{type:"file",onChange:e=>{let t=e.target.files?.[0];if(t){if(t.size>0xa00000)return void alert("Le fichier est trop volumineux. Taille maximum : 10MB");if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return void alert("Type de fichier non support\xe9. Seuls les fichiers PDF, Word et Excel sont accept\xe9s.");m(t)}},accept:".pdf,.doc,.docx,.xls,.xlsx",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, Word, Excel - Max 10MB"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("input",{type:"text",value:p,onChange:e=>u(e.target.value),placeholder:"Description du fichier",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Version"}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>f(e.target.value),placeholder:"1.0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:()=>b(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Annuler"}),(0,r.jsx)("button",{onClick:N,disabled:!x||o,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Upload en cours..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"ri-upload-line"}),"Uploader"]})})]})]}),0===s.length?(0,r.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-file-line text-2xl text-gray-400"})}),(0,r.jsx)("p",{className:"text-gray-600",children:"Aucun fichier TDR disponible"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Ajoutez des fichiers TDR pour cette offre"})]}):(0,r.jsx)("div",{className:"space-y-3",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("i",{className:`text-xl ${C(e.type_mime)}`})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.nom_fichier}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,r.jsx)("span",{children:D(e.taille)}),(0,r.jsxs)("span",{children:["Version ",e.version]}),(0,r.jsx)("span",{children:new Date(e.date_upload).toLocaleDateString("fr-FR")}),e.description&&(0,r.jsx)("span",{className:"text-gray-600",children:e.description})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>v(e.id,e.nom_fichier),className:"text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50 transition-colors",title:"T\xe9l\xe9charger",children:(0,r.jsx)("i",{className:"ri-download-line text-lg"})}),(0,r.jsx)("button",{onClick:()=>w(e.id),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Supprimer",children:(0,r.jsx)("i",{className:"ri-delete-bin-line text-lg"})})]})]},e.id))})]})}var x=s(62873);function m({poleName:e}){return(0,r.jsx)(i.default,{pageName:"pole-lead",children:(0,r.jsx)(p,{poleName:e})})}function p({poleName:e}){let[t,s]=(0,a.useState)([]),[i,d]=(0,a.useState)([]),[m,p]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[f,g]=(0,a.useState)({}),[b,j]=(0,a.useState)(""),[y,N]=(0,a.useState)("dateDepot"),[v,w]=(0,a.useState)("desc"),[D,C]=(0,a.useState)("all"),[k,S]=(0,a.useState)("table"),[M,_]=(0,a.useState)(!1),[B,P]=(0,a.useState)(!1),[A,$]=(0,a.useState)(null),R=()=>{h(!0);try{let t=localStorage.getItem("offres");if(t){let r=JSON.parse(t),a=r.filter(t=>t.poleLead===e&&"approuv\xe9e"===t.statut),i=r.filter(t=>"approuv\xe9e"===t.statut&&t.poleAssocies&&t.poleAssocies.includes(e)),l=a.sort((e,t)=>{let s=e.dateDepot?new Date(e.dateDepot).getTime():0;return(t.dateDepot?new Date(t.dateDepot).getTime():0)-s}),n=i.sort((e,t)=>{let s=e.dateDepot?new Date(e.dateDepot).getTime():0;return(t.dateDepot?new Date(t.dateDepot).getTime():0)-s});d(l),p(n),s([...l,...n]),O([...l,...n]),[...l,...n].forEach(e=>{q(e.id,0)})}}catch(e){console.error("Erreur lors du chargement des offres:",e)}finally{h(!1)}},O=async e=>{if(e.length)try{let t=localStorage.getItem("token");if(!t)return;let s={};for(let r of e)try{let e=await fetch(`/api/fichiers-tdr/offre/${r.id}`,{headers:{Authorization:`Bearer ${t}`}});if(e.ok){let t=await e.json();s[r.id]=t.fichiers?.length||0}else s[r.id]=0}catch(e){console.error(`Erreur lors de la r\xe9cup\xe9ration des fichiers TDR pour l'offre ${r.id}:`,e),s[r.id]=0}g(s)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des compteurs TDR:",e)}},q=(e,t)=>{g(s=>({...s,[e]:t}))},T=e=>{y===e?w("asc"===v?"desc":"asc"):(N(e),w("desc"))},E=async e=>{console.log("T\xe9l\xe9chargement TDR g\xe9r\xe9 par TDRManager pour l'offre:",e.id)},I=e=>{$(e),P(!0)},L=t=>{if(confirm(`\xcates-vous s\xfbr de vouloir annuler l'offre "${t.intituleOffre||t.titre}" ?`))try{let r=localStorage.getItem("offres");if(r){let a=JSON.parse(r).map(e=>e.id===t.id?{...e,statut:"rejet\xe9e",modalite:"annul\xe9e"}:e);localStorage.setItem("offres",JSON.stringify(a)),s(a.filter(t=>t.poleLead===e)),alert("Offre annul\xe9e avec succ\xe8s")}}catch(e){console.error("Erreur lors de l'annulation:",e),alert("Erreur lors de l'annulation de l'offre")}},U=t=>{if(confirm(`Marquer l'offre "${t.intituleOffre||t.titre}" comme mont\xe9e ?`))try{let r=localStorage.getItem("offres");if(r){let a=JSON.parse(r).map(e=>e.id===t.id?{...e,modalite:"mont\xe9e"}:e);localStorage.setItem("offres",JSON.stringify(a)),s(a.filter(t=>t.poleLead===e)),alert("Offre marqu\xe9e comme mont\xe9e avec succ\xe8s")}}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},F=async r=>{if(confirm(`Marquer l'offre "${r.intituleOffre||r.titre}" comme d\xe9pos\xe9e ?`))try{let a=await x.sF.update(r.id,{modalite:"d\xe9pos\xe9e",offreDeposee:!0});if(a.success){let a=t.map(e=>e.id===r.id?{...e,modalite:"d\xe9pos\xe9e",offreDeposee:!0}:e);s(a.filter(t=>t.poleLead===e)),alert("Offre marqu\xe9e comme d\xe9pos\xe9e avec succ\xe8s")}else throw Error(a.error||"Erreur lors de la mise \xe0 jour")}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},z=async r=>{if(confirm(`Marquer l'offre "${r.intituleOffre||r.titre}" comme gagn\xe9e ?`))try{let a=await x.sF.update(r.id,{modalite:"gagn\xe9",statutOffre:"Gagn\xe9e"});if(a.success){let a=t.map(e=>e.id===r.id?{...e,modalite:"gagn\xe9",statutOffre:"Gagn\xe9e"}:e);s(a.filter(t=>t.poleLead===e)),alert("Offre marqu\xe9e comme gagn\xe9e avec succ\xe8s")}else throw Error(a.error||"Erreur lors de la mise \xe0 jour")}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},G=e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},V=e=>e?new Date(e).toLocaleDateString("fr-FR"):"Non sp\xe9cifi\xe9e",J=e=>e&&0!==e.length?e.join(", "):"Non sp\xe9cifi\xe9",W=i.filter(e=>{let t=!b||(e.intituleOffre||e.titre||"").toLowerCase().includes(b.toLowerCase())||(e.bailleur||e.client||"").toLowerCase().includes(b.toLowerCase())||(e.pays||[]).join(" ").toLowerCase().includes(b.toLowerCase()),s="all"===D||e.modalite===D;return t&&s}),H=m.filter(e=>{let t=!b||(e.intituleOffre||e.titre||"").toLowerCase().includes(b.toLowerCase())||(e.bailleur||e.client||"").toLowerCase().includes(b.toLowerCase())||(e.pays||[]).join(" ").toLowerCase().includes(b.toLowerCase()),s="all"===D||e.modalite===D;return t&&s}),K=[...W,...H],X=({offre:e})=>(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[(0,r.jsxs)("button",{onClick:()=>U(e),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"mont\xe9e"===e.modalite?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 hover:bg-green-50 border border-gray-300"}`,title:"Marquer comme mont\xe9e",children:[(0,r.jsx)("i",{className:"ri-check-line mr-1"}),"Mont\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>F(e),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"d\xe9pos\xe9e"===e.modalite?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-yellow-50 border border-gray-300"}`,title:"Marquer comme d\xe9pos\xe9e",children:[(0,r.jsx)("i",{className:"ri-send-plane-line mr-1"}),"D\xe9pos\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>z(e),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"gagn\xe9"===e.modalite?"bg-purple-100 text-purple-800 border border-purple-300":"bg-gray-100 text-gray-700 hover:bg-purple-50 border border-gray-300"}`,title:"Marquer comme gagn\xe9e",children:[(0,r.jsx)("i",{className:"ri-trophy-line mr-1"}),"Gagn\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>L(e),className:`px-3 py-1 text-xs font-medium rounded-full transition-colors ${"annul\xe9e"===e.modalite?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-700 hover:bg-red-50 border border-gray-300"}`,title:"Annuler l'offre",children:[(0,r.jsx)("i",{className:"ri-close-line mr-1"}),"Annuler"]})]}),Q=()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line text-blue-600 mr-2"}),"Modalit\xe9s de R\xe9partition - ",e]}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Tableau complet des modalit\xe9s renseign\xe9es dans le formulaire de gestion de r\xe9partition"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Offre"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bailleur"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pays"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Secteurs"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diligences"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clarifications"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"D\xe9lais"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montage"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"P\xf4les"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Administratif"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:K.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.intituleOffre||e.titre||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.commentaire&&e.commentaire.length>50?`${e.commentaire.substring(0,50)}...`:e.commentaire})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:J(e.pays)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.objectifs||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.diligencesMenees||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.adresseDemandeClarifications||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{children:["Clarification: ",V(e.delaiDemandeClarification)]}),(0,r.jsxs)("div",{children:["R\xe9ception: ",V(e.delaiAccuseReception)]}),(0,r.jsxs)("div",{children:["Intention: ",V(e.delaiIntentionSoumission)]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.chargeMontageAdministratif||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{className:"font-medium",children:["Lead: ",e.poleLead||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:["Associ\xe9s: ",e.poleAssocies||"Non attribu\xe9"]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{children:["Transmission: ",V(e.delaiTransmissionMontageAdministratif)]}),(0,r.jsxs)("div",{children:["D\xe9p\xf4t: ",V(e.delaiDepot)]}),(0,r.jsxs)("div",{children:["D\xe9pos\xe9e: ",e.offreDeposee?"Oui":"Non"]}),e.chargeMontageAdministratif&&(0,r.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["Charg\xe9: ",e.chargeMontageAdministratif]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${G(e.statut||"")}`,children:e.statutOffre||e.statut||"Non sp\xe9cifi\xe9"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.montant&&e.devise?`${e.montant} ${e.devise}`:"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>I(e),className:"text-blue-600 hover:text-blue-900",title:"Voir les d\xe9tails",children:(0,r.jsx)("i",{className:"ri-eye-line"})}),(0,r.jsx)("button",{onClick:()=>E(e),className:"text-purple-600 hover:text-purple-900",title:"T\xe9l\xe9charger TDR",children:(0,r.jsx)("i",{className:"ri-download-line"})})]})})]},e.id))})]})})]}),Y=()=>(0,r.jsx)("div",{className:"grid gap-6",children:K.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-bold text-gray-900",children:e.intituleOffre||e.titre||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"})]}),(0,r.jsx)("span",{className:`inline-flex px-3 py-1 text-sm font-semibold rounded-full ${G(e.statut||"")}`,children:e.statutOffre||e.statut||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"Informations de base"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Pays:"})," ",J(e.pays)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Secteurs:"})," ",e.objectifs||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Budget:"})," ",e.montant&&e.devise?`${e.montant} ${e.devise}`:"Non sp\xe9cifi\xe9"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"Diligences et clarifications"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Diligences:"})," ",e.diligencesMenees||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Clarifications:"})," ",e.adresseDemandeClarifications||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"D\xe9lai clarif.:"})," ",V(e.delaiDemandeClarification)]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"P\xf4les et montage"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"P\xf4le Lead:"})," ",e.poleLead||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"P\xf4le Associ\xe9s:"})," ",e.poleAssocies||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Charge montage:"})," ",e.chargeMontageAdministratif||"Non sp\xe9cifi\xe9"]})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["D\xe9p\xf4t: ",V(e.delaiDepot)]}),(0,r.jsx)("span",{className:"mx-2",children:"•"}),(0,r.jsxs)("span",{children:["D\xe9pos\xe9e: ",e.offreDeposee?"Oui":"Non"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>I(e),className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-eye-line mr-1"}),"Voir"]}),(0,r.jsxs)("button",{onClick:()=>E(e),className:"text-purple-600 hover:text-purple-900 text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-download-line mr-1"}),"TDR"]})]})]})})]},e.id))});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(o.A,{}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6",children:[(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,r.jsx)("i",{className:"ri-check-line mr-2 text-green-600"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Affichage des offres approuv\xe9es uniquement - ",i.length," en tant que p\xf4le lead, ",m.length," en tant que p\xf4le associ\xe9"]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-search-line mr-2"}),"Rechercher"]}),(0,r.jsx)("input",{type:"text",value:b,onChange:e=>j(e.target.value),placeholder:"Rechercher par titre, bailleur, pays...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line mr-2"}),"Modalit\xe9"]}),(0,r.jsxs)("select",{value:D,onChange:e=>C(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"all",children:"Toutes les modalit\xe9s"}),(0,r.jsx)("option",{value:"nouveau",children:"Nouveau"}),(0,r.jsx)("option",{value:"mont\xe9e",children:"Mont\xe9e"}),(0,r.jsx)("option",{value:"d\xe9pos\xe9e",children:"D\xe9pos\xe9e"}),(0,r.jsx)("option",{value:"gagn\xe9",children:"Gagn\xe9"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-layout-line mr-2"}),"Vue"]}),(0,r.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>S("table"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"table"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>S("cards"),className:`flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"cards"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line mr-2"}),"Modalit\xe9s R\xe9partition"]}),(0,r.jsxs)("button",{onClick:()=>_(!M),className:`w-full px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 ${M?"bg-green-600 hover:bg-green-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[(0,r.jsx)("i",{className:"ri-file-list-3-line"}),M?"Masquer":"Afficher"]})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsxs)("button",{onClick:R,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-refresh-line"}),"Actualiser"]})})]})]}),M&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-blue-900",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line mr-2"}),"Modalit\xe9s de R\xe9partition - ",e]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>S("table"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"table"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>S("cards"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"cards"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]}),(0,r.jsxs)("p",{className:"text-blue-700 text-sm",children:["Affichage de toutes les modalit\xe9s renseign\xe9es dans le formulaire de gestion de r\xe9partition pour le ",e,"."]})]}),"table"===k?(0,r.jsx)(Q,{}):(0,r.jsx)(Y,{})]}),!M&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200 bg-blue-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-blue-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-star-line text-blue-600 mr-2"}),"Lead en montage"]}),(0,r.jsxs)("p",{className:"text-blue-700 mt-1",children:[W.length," offre",W.length>1?"s":""," o\xf9 ",e," est le p\xf4le lead"]})]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>S("table"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"table"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>S("cards"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"cards"===k?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:0===W.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune offre en tant que p\xf4le lead"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[e," n'a actuellement aucune offre approuv\xe9e o\xf9 il est le p\xf4le lead."]})]}):"table"===k?(0,r.jsx)(l,{offres:W,loading:u,poleName:e,onViewOffre:I,onDeleteOffre:L,onDownloadTDR:E,searchTerm:b,sortBy:y,sortOrder:v,onSort:T,selectedModalite:D}):(0,r.jsx)("div",{className:"grid gap-6",children:W.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-blue-200",children:[(0,r.jsx)(n.A,{offre:e,showActions:!0,onViewOffre:I,onDeleteOffre:L,onDownloadTDR:E,showPoleInfo:!1,showModalite:!0,showPriority:!0,showBudget:!0,showDate:!0,showStatus:!0,showTDR:!0,showDescription:!0,showDetails:!0,showCommentaire:!1}),(0,r.jsx)(X,{offre:e})]},e.id))})})]}),{}),(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-green-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200 bg-green-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-green-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-team-line text-green-600 mr-2"}),"Associ\xe9 en montage"]}),(0,r.jsxs)("p",{className:"text-green-700 mt-1",children:[H.length," offre",H.length>1?"s":""," o\xf9 ",e," est choisi comme p\xf4le associ\xe9"]})]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>S("table"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"table"===k?"bg-green-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>S("cards"),className:`flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ${"cards"===k?"bg-green-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:0===H.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-green-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune offre en tant que p\xf4le associ\xe9"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[e," n'a actuellement aucune offre approuv\xe9e o\xf9 il est choisi comme p\xf4le associ\xe9."]})]}):"table"===k?(0,r.jsx)(l,{offres:H,loading:u,poleName:e,onViewOffre:I,onDeleteOffre:L,onDownloadTDR:E,searchTerm:b,sortBy:y,sortOrder:v,onSort:T,selectedModalite:D}):(0,r.jsx)("div",{className:"grid gap-6",children:H.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-green-200",children:[(0,r.jsx)(n.A,{offre:e,showActions:!0,onViewOffre:I,onDeleteOffre:L,onDownloadTDR:E,showPoleInfo:!1,showModalite:!0,showPriority:!0,showBudget:!0,showDate:!0,showStatus:!0,showTDR:!0,showDescription:!0,showDetails:!0,showCommentaire:!1}),(0,r.jsx)(X,{offre:e})]},e.id))})})]}),{})]}),M&&("table"===k?(0,r.jsx)(Q,{}):(0,r.jsx)(Y,{})),B&&A&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"D\xe9tails de l'offre"}),(0,r.jsx)("button",{onClick:()=>{P(!1),$(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("i",{className:"ri-close-line text-2xl"})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Informations principales"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Intitul\xe9 de l'offre"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:A.intituleOffre||A.titre||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Bailleur"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.bailleur||A.client||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Pays"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.pays&&A.pays.length>0?A.pays.join(", "):"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Priorit\xe9"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.priorite||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Modalit\xe9"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.modalite||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600 mb-3 block",children:"Actions de modalit\xe9"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{U(A),P(!1),$(null)},className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${"mont\xe9e"===A.modalite?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 hover:bg-green-50 border border-gray-300"}`,children:[(0,r.jsx)("i",{className:"ri-check-line mr-1"}),"Marquer comme mont\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{F(A),P(!1),$(null)},className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${"d\xe9pos\xe9e"===A.modalite?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-yellow-50 border border-gray-300"}`,children:[(0,r.jsx)("i",{className:"ri-send-plane-line mr-1"}),"Marquer comme d\xe9pos\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{z(A),P(!1),$(null)},className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${"gagn\xe9"===A.modalite?"bg-purple-100 text-purple-800 border border-purple-300":"bg-gray-100 text-gray-700 hover:bg-purple-50 border border-gray-300"}`,children:[(0,r.jsx)("i",{className:"ri-trophy-line mr-1"}),"Marquer comme gagn\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{L(A),P(!1),$(null)},className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${"annul\xe9e"===A.modalite?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-700 hover:bg-red-50 border border-gray-300"}`,children:[(0,r.jsx)("i",{className:"ri-close-line mr-1"}),"Annuler l'offre"]})]})]}),(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,r.jsx)(c,{offreId:A.id,onFichiersUpdate:()=>{R()}})})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Informations suppl\xe9mentaires"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Date de d\xe9p\xf4t"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.dateDepot?new Date(A.dateDepot).toLocaleDateString("fr-FR"):"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Montant"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.montant&&A.devise?`${A.montant} ${A.devise}`:"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Dur\xe9e de mission"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.dureeMission||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Objectifs"}),(0,r.jsx)("p",{className:"text-gray-900",children:A.objectifs||"Non sp\xe9cifi\xe9s"})]})]})]})]}),A.commentaire&&(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Commentaires"}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:A.commentaire})]})]})]})})]})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},41200:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Desktop\\\\Projet du pole Informatique\\\\Dossier d\xe9veloppement\\\\BMS 3\\\\BMS_06_08_25\\\\BMS_06_08_25\\\\BMS\\\\frontend\\\\components\\\\HomeButton.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\components\\HomeButton.tsx","default")},45388:(e,t,s)=>{Promise.resolve().then(s.bind(s,25290)),Promise.resolve().then(s.bind(s,55006)),Promise.resolve().then(s.bind(s,96485)),Promise.resolve().then(s.bind(s,90078))},54697:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Desktop\\\\Projet du pole Informatique\\\\Dossier d\xe9veloppement\\\\BMS 3\\\\BMS_06_08_25\\\\BMS_06_08_25\\\\BMS\\\\frontend\\\\app\\\\repartition\\\\pole-lead\\\\[pole]\\\\PoleOffresClient.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\app\\repartition\\pole-lead\\[pole]\\PoleOffresClient.tsx","default")},56566:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(5853),a=s(60554),i=s(30708),l=s.n(i),n=s(8067),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d={children:["",{children:["repartition",{children:["pole-lead",{children:["[pole]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,99072)),"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\app\\repartition\\pole-lead\\[pole]\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,97898)),"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.bind(s,73706)),"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\app\\not-found.tsx"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,82137,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,48358,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\app\\repartition\\pole-lead\\[pole]\\page.tsx"],x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/repartition/pole-lead/[pole]/page",pathname:"/repartition/pole-lead/[pole]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},58540:(e,t,s)=>{Promise.resolve().then(s.bind(s,54697)),Promise.resolve().then(s.bind(s,41200)),Promise.resolve().then(s.bind(s,92955)),Promise.resolve().then(s.bind(s,3020))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},92955:(e,t,s)=>{"use strict";s.d(t,{default:()=>r});let r=(0,s(20413).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\User\\\\Desktop\\\\Projet du pole Informatique\\\\Dossier d\xe9veloppement\\\\BMS 3\\\\BMS_06_08_25\\\\BMS_06_08_25\\\\BMS\\\\frontend\\\\components\\\\Layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\User\\Desktop\\Projet du pole Informatique\\Dossier d\xe9veloppement\\BMS 3\\BMS_06_08_25\\BMS_06_08_25\\BMS\\frontend\\components\\Layout.tsx","default")},99072:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c,generateStaticParams:()=>d});var r=s(57307),a=s(6174),i=s(54697),l=s(3020),n=s(41200),o=s(92955);async function d(){return["P\xf4le sant\xe9","P\xf4le Wash","P\xf4le Education","P\xf4le Climat","P\xf4le Enqu\xeates","P\xf4le Mod\xe9lisation","P\xf4le Finances Publiques","P\xf4le D\xe9centralisation","P\xf4le Coh\xe9sion sociale","P\xf4le Anglophone","P\xf4le SIDIA","Montage Administrative"].map(e=>({pole:e}))}async function c({params:e}){let{pole:t}=await e,s=decodeURIComponent(t);return(0,r.jsx)(l.default,{pageName:"pole-lead",children:(0,r.jsx)(o.default,{children:(0,r.jsx)(x,{poleName:s})})})}function x({poleName:e}){return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white",children:[(0,r.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-800 py-12",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"text-center text-white",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-500/30 backdrop-blur-sm rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-building-line text-2xl"})}),(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold mb-4",children:e}),(0,r.jsx)("p",{className:"text-xl opacity-90 mb-6",children:"Offres attribu\xe9es \xe0 ce p\xf4le"}),(0,r.jsx)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg px-4 py-2 inline-block",children:(0,r.jsx)("span",{className:"text-lg",children:"Gestion des r\xe9partitions"})})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8",children:[(0,r.jsx)("div",{className:"mb-8 flex justify-end items-center",children:(0,r.jsx)(n.default,{variant:"outline",size:"sm"})}),(0,r.jsx)(a.Suspense,{fallback:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-12 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Chargement des offres pour ",e,"..."]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Cette page affichera les offres attribu\xe9es \xe0 ce p\xf4le une fois charg\xe9es."})]}),children:(0,r.jsx)(i.default,{poleName:e})})]})]})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[105,94,227,926,794,274],()=>s(56566));module.exports=r})();