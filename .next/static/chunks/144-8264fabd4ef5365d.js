"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[144],{150:(e,t,s)=>{s.d(t,{default:()=>i});var r=s(73365),a=s(59534),n=s.n(a);function i(e){let{className:t="",variant:s="default",size:a="md"}=e,i="".concat("inline-flex items-center gap-2 font-medium transition-all duration-200 hover:scale-105"," ").concat({default:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 shadow-sm hover:shadow-md",outline:"border-2 border-blue-600 text-blue-600 px-4 py-2 rounded-lg hover:bg-blue-600 hover:text-white",icon:"bg-blue-100 text-blue-600 p-2 rounded-lg hover:bg-blue-200"}[s]," ").concat({sm:"text-sm px-3 py-1.5",md:"text-base px-4 py-2",lg:"text-lg px-6 py-3"}[a]," ").concat(t);return(0,r.jsxs)(n(),{href:"/",className:i,children:[(0,r.jsx)("i",{className:"ri-home-line"}),"icon"!==s&&(0,r.jsx)("span",{children:"Accueil"})]})}},57964:(e,t,s)=>{s.d(t,{A:()=>a});var r=s(73365);function a(e){var t;let s,{offre:a,showActions:n=!1,onViewOffre:i,onEditOffre:o,onDeleteOffre:l,onDownloadTDR:c,showPoleInfo:d=!1,showModalite:m=!1,showPriority:u=!0,showBudget:g=!0,showDate:x=!0,showStatus:h=!0,showTDR:p=!1,showDescription:f=!0,showDetails:y=!0,showCommentaire:b=!1,showTDRCount:v=!1,tdrCount:N=0,className:j=""}=e,E=e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Non sp\xe9cifi\xe9e";return(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-xl border border-blue-100 overflow-hidden ".concat(j),children:(0,r.jsxs)("div",{className:"p-8",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[h&&(0,r.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium border ".concat((e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(a.statut||"en_attente")),children:[(0,r.jsx)("i",{className:"".concat("approuv\xe9e"===a.statut?"ri-check-line":"rejet\xe9e"===a.statut?"ri-close-line":"ri-time-line"," mr-1")}),(e=>{switch(e){case"approuv\xe9e":return"Approuv\xe9e";case"rejet\xe9e":return"Rejet\xe9e";case"en_attente":default:return"En attente";case"brouillon":return"Brouillon"}})(a.statut||"en_attente")]}),u&&a.priorite&&(0,r.jsx)("span",{className:"bg-orange-100 text-orange-800 px-3 py-1 rounded-full text-sm font-medium",children:a.priorite}),m&&a.modalite&&(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat((e=>{switch(e){case"gagn\xe9":return"bg-green-100 text-green-800";case"d\xe9pos\xe9e":return"bg-blue-100 text-blue-800";case"mont\xe9e":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}})(a.modalite)),children:a.modalite}),d&&a.poleLead&&(0,r.jsxs)("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-building-line mr-1"}),a.poleLead]}),v&&N>0&&(0,r.jsxs)("span",{className:"bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line mr-1"}),N," fichier",N>1?"s":""," TDR"]})]}),(0,r.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-3",children:a.intituleOffre||a.titre||"Sans titre"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 text-sm text-gray-600 mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-building-line"}),(0,r.jsx)("span",{children:a.bailleur||a.client||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-price-tag-3-line"}),(0,r.jsx)("span",{children:a.typeOffre||a.secteur||"Non sp\xe9cifi\xe9"})]}),x&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-calendar-line"}),(0,r.jsxs)("span",{children:["Date: ",E(a.dateSoumissionValidation||a.dateCreation||a.dateDepot||"")]})]}),a.dateValidation&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-check-double-line"}),(0,r.jsxs)("span",{children:["Valid\xe9e le: ",E(a.dateValidation)]})]}),d&&a.poleAssocies&&(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-team-line"}),(0,r.jsxs)("span",{children:["P\xf4le associ\xe9: ",a.poleAssocies]})]})]})]}),g&&(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("div",{className:"text-3xl font-bold text-blue-600 mb-1",children:(s=a.montant||a.budget||"")?s.replace("€"," €"):"Non sp\xe9cifi\xe9"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:"Budget estim\xe9"})]})]}),f&&(0,r.jsxs)("div",{className:"prose max-w-none mb-8",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:"Description du Projet"}),(0,r.jsx)("p",{className:"text-gray-600 leading-relaxed",children:a.objectifs||a.description||"Aucune description disponible"})]}),y&&(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-8 mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations Compl\xe9mentaires"}),(0,r.jsxs)("div",{className:"space-y-3",children:[a.pays&&a.pays.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Pays: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:(t=a.pays)&&0!==t.length?t.join(", "):"Non sp\xe9cifi\xe9"})]}),a.autrePays&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Autre pays: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:a.autrePays})]}),a.dureeMission&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Dur\xe9e de mission: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:a.dureeMission})]}),a.offreTrouveePar&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Offre trouv\xe9e par: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:a.offreTrouveePar})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"D\xe9tails Techniques"}),(0,r.jsxs)("div",{className:"space-y-3",children:[a.profilExpert&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Profil expert: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:a.profilExpert})]}),a.nomSite&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Nom du site: "}),(0,r.jsx)("span",{className:"text-sm text-gray-900",children:a.nomSite})]}),p&&(a.lienTDR||a.tdrFile)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"TDR: "}),c?(0,r.jsx)("button",{onClick:()=>c(a),className:"text-sm text-blue-600 hover:text-blue-800",children:"T\xe9l\xe9charger"}):(0,r.jsx)("a",{href:a.lienTDR||a.tdrFile,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-800",children:"Voir les TDR"})]})]})]})]}),b&&a.commentaireValidation&&(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Commentaire de Validation"}),(0,r.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,r.jsx)("p",{className:"text-gray-700",children:a.commentaireValidation})})]}),n&&(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[i&&(0,r.jsxs)("button",{onClick:()=>i(a),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-eye-line"}),"Voir les D\xe9tails"]}),o&&(0,r.jsxs)("button",{onClick:()=>o(a),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-edit-line"}),"Modifier"]}),l&&(0,r.jsxs)("button",{onClick:()=>l(a),className:"bg-red-600 hover:bg-red-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-delete-bin-line"}),"Supprimer"]}),c&&(a.lienTDR||a.tdrFile)&&(0,r.jsxs)("button",{onClick:()=>c(a),className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-download-line"}),"T\xe9l\xe9charger TDR"]})]})]})})}},63925:(e,t,s)=>{s.d(t,{H2:()=>m,R2:()=>u,sF:()=>g,dR:()=>x,c9:()=>h});var r=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e.CRITICAL="CRITICAL",e}({});class a{formatMessage(e){let t=new Date(e.timestamp).toLocaleTimeString(),s=e.context?"[".concat(e.context,"]"):"",r="[".concat(e.level,"]"),a="".concat(t," ").concat(r," ").concat(s," ").concat(e.message);return e.data&&(a+=" | Data: ".concat(JSON.stringify(e.data))),e.error&&(a+=" | Error: ".concat(e.error.message),e.error.stack&&(a+=" | Stack: ".concat(e.error.stack))),a}addLog(e){if(this.logs.push(e),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs)),this.isDevelopment){let t=this.formatMessage(e);switch(e.level){case"DEBUG":console.debug(t);break;case"INFO":console.info(t);break;case"WARN":console.warn(t);break;case"ERROR":case"CRITICAL":console.error(t)}}!this.isDevelopment&&e.level>="ERROR"&&this.sendToMonitoring(e)}async sendToMonitoring(e){try{{let t=JSON.parse(localStorage.getItem("bms_monitoring_logs")||"[]");t.push(e),localStorage.setItem("bms_monitoring_logs",JSON.stringify(t.slice(-100)))}}catch(e){console.error("Erreur lors de l'envoi au monitoring:",e)}}debug(e,t,s){this.addLog({level:"DEBUG",message:e,context:t,data:s,timestamp:new Date().toISOString()})}info(e,t,s){this.addLog({level:"INFO",message:e,context:t,data:s,timestamp:new Date().toISOString()})}warn(e,t,s){this.addLog({level:"WARN",message:e,context:t,data:s,timestamp:new Date().toISOString()})}error(e,t,s,r){this.addLog({level:"ERROR",message:e,error:t,context:s,data:r,timestamp:new Date().toISOString()})}critical(e,t,s,r){this.addLog({level:"CRITICAL",message:e,error:t,context:s,data:r,timestamp:new Date().toISOString()})}apiError(e,t,s,r){this.error("Erreur API sur ".concat(e),t,"API",{endpoint:e,status:null==s?void 0:s.status,statusText:null==s?void 0:s.statusText,url:null==s?void 0:s.url,data:r})}dashboardError(e,t,s,r){this.error("Erreur Dashboard: ".concat(e),t,"Dashboard",{operation:e,filters:s,data:r})}authError(e,t,s){this.error("Erreur Auth: ".concat(e),t,"Auth",s)}getRecentLogs(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,s=this.logs;return e&&(s=s.filter(t=>t.level===e)),s.slice(-t)}exportLogs(){return JSON.stringify(this.logs,null,2)}clearLogs(){this.logs=[]}getLogStats(){let e={total:this.logs.length,byLevel:{},recentErrors:this.logs.filter(e=>e.level>="ERROR").slice(-10)};return Object.values(r).forEach(t=>{e.byLevel[t]=this.logs.filter(e=>e.level===t).length}),e}constructor(){this.logs=[],this.maxLogs=1e3,this.isDevelopment=!1}}let n=new a,i=(e,t,s)=>n.info(e,t,s),o=(e,t,s)=>n.warn(e,t,s),l=(e,t,s,r)=>n.error(e,t,s,r);var c=s(94089);let d={BASE_URL:"http://localhost:5000",NODE_ENV:"production",APP_NAME:c.env.NEXT_PUBLIC_APP_NAME||"BMS",APP_VERSION:c.env.NEXT_PUBLIC_APP_VERSION||"1.0.0",REQUEST_TIMEOUT:1e4,MAX_RETRIES:3,RETRY_DELAY:1e3}.BASE_URL;i("Configuration: NEXT_PUBLIC_API_URL=".concat("http://localhost:5000"),"API"),i("URL de base utilis\xe9e: ".concat(d),"API");let m=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s="".concat(d).concat(e),r=localStorage.getItem("token");i("Appel vers: ".concat(s),"API"),i("Token pr\xe9sent: ".concat(r?"OUI":"NON"),"API"),r&&(i("Token (premiers caract\xe8res): ".concat(r.substring(0,20),"..."),"API"),i("Longueur du token: ".concat(r.length),"API"));let a={headers:{"Content-Type":"application/json",...r&&{Authorization:"Bearer ".concat(r)},...t.headers},...t};try{let t;i("Envoi de la requ\xeate vers: ".concat(s),"API");let r=await fetch(s,a);if(i("R\xe9ponse re\xe7ue: ".concat(r.status," ").concat(r.statusText),"API"),i("Headers de r\xe9ponse: ".concat(JSON.stringify(Object.fromEntries(r.headers.entries()))),"API"),!r.ok){let t={};try{t=await r.json()}catch(e){o("Impossible de parser le body d'erreur: ".concat(e instanceof Error?e.message:String(e)),"API"),t={error:"Erreur HTTP ".concat(r.status,": ").concat(r.statusText)}}if(n.apiError(e,Error("HTTP ".concat(r.status,": ").concat(r.statusText)),r,{status:r.status,statusText:r.statusText,url:s,errorData:t,headers:Object.fromEntries(r.headers.entries())}),401===r.status)throw n.authError("Token invalide",Error(t.error||"Token expir\xe9 ou invalide"),t),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),i("Token invalide supprim\xe9 du localStorage","API"),"/login"!==window.location.pathname&&(i("Redirection vers /login","API"),window.location.href="/login"),Error("Token invalide - Redirection vers la connexion");let a=t.error||t.message||"Erreur HTTP ".concat(r.status,": ").concat(r.statusText);throw Error(a)}try{t=await r.json(),i("Succ\xe8s: ".concat(e),"API",t)}catch(e){throw l("Erreur lors du parsing de la r\xe9ponse: ".concat(e instanceof Error?e.message:String(e)),e instanceof Error?e:Error(String(e)),"API"),Error("Erreur lors du parsing de la r\xe9ponse: ".concat(e instanceof Error?e.message:String(e)))}return t}catch(r){if(n.apiError(e,r instanceof Error?r:Error(String(r)),void 0,{url:s,timestamp:new Date().toISOString()}),(r instanceof Error?r.message:String(r))==="Token invalide - Redirection vers la connexion")throw r;let t="Erreur lors de la r\xe9cup\xe9ration des donn\xe9es: ".concat(r instanceof Error?r.message:String(r));throw e.includes("/performance/")&&(t="Impossible de charger les donn\xe9es de performance. V\xe9rifiez votre connexion et r\xe9essayez."),l("Message d'erreur am\xe9lior\xe9: ".concat(t),r instanceof Error?r:Error(String(r)),"API"),Error(t)}},u={login:async e=>m("/api/auth/login",{method:"POST",body:JSON.stringify(e)}),logout:async()=>(localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),{success:!0,message:"D\xe9connexion r\xe9ussie"}),register:async e=>m("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),verifyToken:async()=>m("/api/auth/verify")},g={getAll:async()=>m("/api/offres"),create:async e=>m("/api/offres",{method:"POST",body:JSON.stringify(e)}),update:async(e,t)=>m("/api/offres/".concat(e),{method:"PUT",body:JSON.stringify(t)}),delete:async e=>m("/api/offres/".concat(e),{method:"DELETE"}),validate:async(e,t)=>m("/api/offres/".concat(e,"/validate"),{method:"PATCH",body:JSON.stringify(t)})},x={getOverview:async(e,t)=>{let s=e&&t?"?startDate=".concat(e,"&endDate=").concat(t):"";return m("/api/performance/overview".concat(s))},getPoles:async(e,t)=>{let s=e&&t?"?startDate=".concat(e,"&endDate=").concat(t):"";return m("/api/performance/poles".concat(s))},getPolesDetailed:async(e,t)=>{let s=e&&t?"?startDate=".concat(e,"&endDate=").concat(t):"";return m("/api/performance/poles-detailed".concat(s))},getTrends:async()=>m("/api/performance/trends"),getCommerciaux:async(e,t)=>{let s=e&&t?"?startDate=".concat(e,"&endDate=").concat(t):"";return m("/api/performance/commerciaux".concat(s))},getMetrics:async()=>m("/api/performance/metrics")},h={getAll:async e=>m("/api/scheduled-searches?userId=".concat(e)),getOptions:async()=>m("/api/scheduled-searches/options"),create:async e=>m("/api/scheduled-searches",{method:"POST",body:JSON.stringify(e)}),update:async e=>m("/api/scheduled-searches",{method:"PUT",body:JSON.stringify(e)}),delete:async e=>m("/api/scheduled-searches",{method:"DELETE",body:JSON.stringify(e)}),getSavedKeywords:async e=>m("/api/scheduled-searches/saved-keywords?userId=".concat(e)),saveKeywords:async e=>m("/api/scheduled-searches/saved-keywords",{method:"POST",body:JSON.stringify(e)}),deleteSavedKeywords:async(e,t)=>m("/api/scheduled-searches/saved-keywords/".concat(e),{method:"DELETE",body:JSON.stringify({userId:t})}),getSearchStats:async e=>m("/api/scheduled-searches/search-stats".concat(e?"?userId=".concat(e):""))}}}]);