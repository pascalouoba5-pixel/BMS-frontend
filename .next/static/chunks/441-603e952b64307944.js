"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[441],{150:(e,t,s)=>{s.d(t,{default:()=>n});var r=s(73365),l=s(59534),a=s.n(l);function n(e){let{className:t="",variant:s="default",size:l="md"}=e,n="".concat("inline-flex items-center gap-2 font-medium transition-all duration-200 hover:scale-105"," ").concat({default:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 shadow-sm hover:shadow-md",outline:"border-2 border-blue-600 text-blue-600 px-4 py-2 rounded-lg hover:bg-blue-600 hover:text-white",icon:"bg-blue-100 text-blue-600 p-2 rounded-lg hover:bg-blue-200"}[s]," ").concat({sm:"text-sm px-3 py-1.5",md:"text-base px-4 py-2",lg:"text-lg px-6 py-3"}[l]," ").concat(t);return(0,r.jsxs)(a(),{href:"/",className:n,children:[(0,r.jsx)("i",{className:"ri-home-line"}),"icon"!==s&&(0,r.jsx)("span",{children:"Accueil"})]})}},21332:(e,t,s)=>{s.d(t,{A:()=>l});var r=s(1521);let l=()=>{let[e,t]=(0,r.useState)({token:null,user:null,isAuthenticated:!1,userRole:null});(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s){let r=JSON.parse(s);t({token:e,user:r,isAuthenticated:!0,userRole:r.role||null})}},[]);let s=(0,r.useCallback)((e,s)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(s)),t({token:e,user:s,isAuthenticated:!0,userRole:s.role||null})},[]),l=(0,r.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t({token:null,user:null,isAuthenticated:!1,userRole:null})},[]),a=(0,r.useCallback)(e=>{localStorage.setItem("token",e),t(t=>({...t,token:e}))},[]);return{...e,login:s,logout:l,updateToken:a}}},31956:(e,t,s)=>{s.d(t,{cj:()=>a,fz:()=>n});var r=s(73365);s(1521),s(50627);var l=s(21332);function a(e){let{children:t}=e,{userRole:s}=(0,l.A)();return"s_admin"!==s?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full mx-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-shield-cross-line text-2xl text-red-600"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acc\xe8s Refus\xe9"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Cette page est r\xe9serv\xe9e aux super administrateurs uniquement."}),(0,r.jsx)("button",{onClick:()=>window.history.back(),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"Retour"})]})})}):(0,r.jsx)(r.Fragment,{children:t})}function n(e){let{children:t}=e,{userRole:s}=(0,l.A)();return"admin"!==s&&"s_admin"!==s?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white flex items-center justify-center",children:(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-xl p-8 max-w-md w-full mx-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-shield-cross-line text-2xl text-red-600"})}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acc\xe8s Refus\xe9"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Cette page est r\xe9serv\xe9e aux administrateurs uniquement."}),(0,r.jsx)("button",{onClick:()=>window.history.back(),className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold transition-colors",children:"Retour"})]})})}):(0,r.jsx)(r.Fragment,{children:t})}},84857:(e,t,s)=>{s.d(t,{default:()=>n});var r=s(73365),l=s(49458),a=s(98809);function n(e){let{children:t}=e;return(0,r.jsxs)("div",{className:"flex h-screen bg-gray-50",children:[(0,r.jsx)(l.A,{}),(0,r.jsxs)("main",{className:"flex-1 overflow-auto md:ml-72 transition-all duration-300",children:[(0,r.jsx)(a.A,{}),(0,r.jsx)("div",{className:"min-h-full",children:t})]})]})}},98809:(e,t,s)=>{s.d(t,{A:()=>n});var r=s(73365),l=s(1521),a=s(99789);let n=e=>{let{className:t=""}=e,{alerts:s,isVisible:n,toggleAlerts:i,closeAlert:o}=(0,a.Z)(),[c,d]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{d(!0)},[]),c&&n&&0!==s.length)?(0,r.jsxs)("div",{className:"fixed top-0 left-0 right-0 z-50 ".concat(t),children:[(0,r.jsx)("div",{className:"absolute top-2 right-2 z-10",children:(0,r.jsx)("button",{onClick:i,className:"bg-gray-800 text-white px-3 py-1 rounded-full text-xs hover:bg-gray-700 transition-colors",title:"Masquer les alertes",children:"✕"})}),(0,r.jsx)("div",{className:"bg-gradient-to-r from-orange-500 to-red-600 text-white p-4 shadow-lg",children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"text-xl",children:"⚠️"}),(0,r.jsxs)("h3",{className:"font-semibold text-lg",children:["Alertes d'\xe9ch\xe9ances (",s.length,")"]})]}),(0,r.jsxs)("div",{className:"text-sm opacity-90",children:["Derni\xe8re mise \xe0 jour : ",new Date().toLocaleTimeString("fr-FR")]})]}),(0,r.jsx)("div",{className:"space-y-2",children:s.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border-l-4 ".concat(e.isExpired?"bg-red-800 border-red-400 animate-pulse":e.isUrgent?"bg-red-600 border-red-300 animate-pulse":"bg-orange-600 border-orange-300"),children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,r.jsx)("span",{className:"font-semibold",children:e.title}),e.isUrgent&&(0,r.jsx)("span",{className:"bg-red-400 text-red-900 px-2 py-1 rounded-full text-xs font-bold",children:"URGENT"}),e.isExpired&&(0,r.jsx)("span",{className:"bg-red-400 text-red-900 px-2 py-1 rounded-full text-xs font-bold",children:"EXPIR\xc9"})]}),(0,r.jsx)("p",{className:"text-sm opacity-90 mb-1",children:e.message}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-xs",children:[(0,r.jsx)("span",{className:"font-mono bg-black/20 px-2 py-1 rounded",children:e.timeRemaining}),e.offreTitle&&(0,r.jsxs)("span",{className:"opacity-75",children:["Offre: ",e.offreTitle]})]})]}),(0,r.jsx)("button",{onClick:()=>o(e.id),className:"ml-4 text-white/80 hover:text-white transition-colors",title:"Fermer cette alerte",children:"✕"})]},e.id))})]})})]}):null}},99789:(e,t,s)=>{s.d(t,{Z:()=>a});var r=s(1521);let l={montageAlertHours:72,depotAlertHours:24,timezone:"UTC"},a=()=>{let[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)(l),[n,i]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(!0)},[]),(0,r.useEffect)(()=>{if(!o)return;let e=localStorage.getItem("alertSettings");if(e)try{let t=JSON.parse(e);a(t)}catch(e){console.error("Erreur lors du chargement des param\xe8tres d'alerte:",e),a(l),localStorage.setItem("alertSettings",JSON.stringify(l))}else a(l),localStorage.setItem("alertSettings",JSON.stringify(l))},[o]);let d=(0,r.useCallback)(e=>{a(e),localStorage.setItem("alertSettings",JSON.stringify(e))},[]),u=(0,r.useCallback)(e=>{let t=new Date,s=e.getTime()-t.getTime();if(s<=0)return"\xc9ch\xe9ance d\xe9pass\xe9e";let r=Math.floor(s/36e5),l=Math.floor(s%36e5/6e4);if(r>24){let e=Math.floor(r/24);return"".concat(e,"j ").concat(r%24,"h ").concat(l,"m")}return"".concat(r,"h ").concat(l,"m")},[]),m=(0,r.useCallback)((e,t)=>{let s=new Date,r=(e.getTime()-s.getTime())/36e5;return r>0&&r<=t},[]),x=(0,r.useCallback)(e=>{let t=new Date;return e.getTime()<=t.getTime()},[]),f=(0,r.useCallback)(e=>{let t=new Date,s=(e.getTime()-t.getTime())/36e5;return s>0&&s<=2},[]),g=(0,r.useCallback)(()=>{if(o)try{let e=localStorage.getItem("offres");if(!e)return void t([]);let r=JSON.parse(e),l=[];r.forEach(e=>{if(e.delaiTransmissionMontageAdministratif){let t=new Date(e.delaiTransmissionMontageAdministratif);m(t,s.montageAlertHours)&&l.push({id:"montage-".concat(e.id),type:f(t)?"error":"warning",title:"Montage Administratif",message:"\xc9ch\xe9ance pour le montage administratif de l'offre \"".concat(e.intituleOffre,'"'),timeRemaining:u(t),offreId:e.id,offreTitle:e.intituleOffre,isUrgent:f(t),isExpired:x(t)})}if(e.dateDepotPrevu){let t=new Date(e.dateDepotPrevu);m(t,s.depotAlertHours)&&l.push({id:"depot-".concat(e.id),type:f(t)?"error":"warning",title:"D\xe9p\xf4t d'Offre",message:"\xc9ch\xe9ance pour le d\xe9p\xf4t de l'offre \"".concat(e.intituleOffre,'"'),timeRemaining:u(t),offreId:e.id,offreTitle:e.intituleOffre,isUrgent:f(t),isExpired:x(t)})}}),l.sort((e,t)=>e.isUrgent&&!t.isUrgent?-1:!e.isUrgent&&t.isUrgent?1:0),t(l)}catch(e){console.error("Erreur lors de la g\xe9n\xe9ration des alertes:",e),t([])}},[s,u,m,x,f,o]);(0,r.useEffect)(()=>{if(!o)return;g();let e=setInterval(()=>{g()},6e4),t=()=>{g()},s=e=>{("offres"===e.key||"alertSettings"===e.key)&&g()};return window.addEventListener("alertSettingsChanged",t),window.addEventListener("storage",s),()=>{clearInterval(e),window.removeEventListener("alertSettingsChanged",t),window.removeEventListener("storage",s)}},[g,o]);let h=(0,r.useCallback)(()=>{i(!n)},[n]);return{alerts:e,settings:s,isVisible:n,saveSettings:d,toggleAlerts:h,closeAlert:(0,r.useCallback)(e=>{t(t=>t.filter(t=>t.id!==e))},[]),generateAlerts:g}}}}]);