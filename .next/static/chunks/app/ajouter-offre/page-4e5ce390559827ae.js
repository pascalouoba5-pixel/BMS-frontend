(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[50],{150:(e,r,t)=>{"use strict";t.d(r,{default:()=>n});var a=t(73365),s=t(59534),i=t.n(s);function n(e){let{className:r="",variant:t="default",size:s="md"}=e,n="".concat("inline-flex items-center gap-2 font-medium transition-all duration-200 hover:scale-105"," ").concat({default:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 shadow-sm hover:shadow-md",outline:"border-2 border-blue-600 text-blue-600 px-4 py-2 rounded-lg hover:bg-blue-600 hover:text-white",icon:"bg-blue-100 text-blue-600 p-2 rounded-lg hover:bg-blue-200"}[t]," ").concat({sm:"text-sm px-3 py-1.5",md:"text-base px-4 py-2",lg:"text-lg px-6 py-3"}[s]," ").concat(r);return(0,a.jsxs)(i(),{href:"/",className:n,children:[(0,a.jsx)("i",{className:"ri-home-line"}),"icon"!==t&&(0,a.jsx)("span",{children:"Accueil"})]})}},30094:(e,r,t)=>{Promise.resolve().then(t.bind(t,31069))},31069:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>x});var a=t(73365),s=t(59534),i=t.n(s),n=t(1521),o=t(150),l=t(42770),c=t(84857),d=t(63925);let u=["Afrique du Sud","Alg\xe9rie","Angola","B\xe9nin","Botswana","Burkina Faso","Burundi","Cabo Verde","Cameroun","Comores","Congo (Brazzaville)","Congo (Kinshasa / R\xe9publique d\xe9mocratique du Congo)","C\xf4te d'Ivoire","Djibouti","\xc9gypte","\xc9rythr\xe9e","Eswatini","\xc9thiopie","Gabon","Gambie","Ghana","Guin\xe9e","Guin\xe9e-Bissau","Guin\xe9e \xe9quatoriale","Kenya","Lesotho","Liberia","Libye","Madagascar","Malawi","Mali","Maroc","Maurice","Mauritanie","Mozambique","Namibie","Niger","Nigeria","Ouganda","Rwanda","Sao Tom\xe9-et-Principe","S\xe9n\xe9gal","Seychelles","Sierra Leone","Somalie","Soudan","Soudan du Sud","Tanzanie","Tchad","Togo","Tunisie","Zambie","Zimbabwe","Antigua-et-Barbuda","Argentine","Bahamas","Barbade","Belize","Bolivie","Br\xe9sil","Canada","Chili","Colombie","Costa Rica","Cuba","Dominique","El Salvador","\xc9tats-Unis","Grenade","Guatemala","Guyana","Ha\xefti","Honduras","Jama\xefque","Mexique","Nicaragua","Panama","Paraguay","P\xe9rou","R\xe9publique dominicaine","Saint-Kitts-et-Nevis","Saint-Vincent-et-les-Grenadines","Sainte-Lucie","Suriname","Trinit\xe9-et-Tobago","Uruguay","Venezuela","Afghanistan","Arabie saoudite","Arm\xe9nie","Azerba\xefdjan","Bahre\xefn","Bangladesh","Bhoutan","Birmanie (Myanmar)","Brunei","Cambodge","Chine","Chypre","Cor\xe9e du Nord","Cor\xe9e du Sud","\xc9mirats arabes unis","G\xe9orgie","Inde","Indon\xe9sie","Irak","Iran","Isra\xebl","Japon","Jordanie","Kazakhstan","Kirghizistan","Kowe\xeft","Laos","Liban","Malaisie","Maldives","Mongolie","N\xe9pal","Oman","Ouzb\xe9kistan","Pakistan","Palestine","Philippines","Qatar","Singapour","Sri Lanka","Syrie","Tadjikistan","Ta\xefwan","Tha\xeflande","Timor oriental","Turquie","Turkm\xe9nistan","Vi\xeat Nam","Y\xe9men","Albanie","Allemagne","Andorre","Autriche","Belgique","Bi\xe9lorussie","Bosnie-Herz\xe9govine","Bulgarie","Croatie","Danemark","Espagne","Estonie","Finlande","France","Gr\xe8ce","Hongrie","Irlande","Islande","Italie","Lettonie","Liechtenstein","Lituanie","Luxembourg","Malte","Moldavie","Monaco","Mont\xe9n\xe9gro","Norv\xe8ge","Pays-Bas","Pologne","Portugal","R\xe9publique tch\xe8que","Roumanie","Royaume-Uni","Russie","Saint-Marin","Serbie","Slovaquie","Slov\xe9nie","Su\xe8de","Suisse","Ukraine","Vatican","Australie","Fidji","\xceles Marshall","\xceles Salomon","Kiribati","Micron\xe9sie","Nauru","Nouvelle-Z\xe9lande","Palaos","Papouasie-Nouvelle-Guin\xe9e","Samoa","Tonga","Tuvalu","Vanuatu","Autre"].sort(),m=["EUR","USD","XOF","XAF","GBP","CFA","Autre"],p=["AO","AMI","Avis G\xe9n\xe9ral","Appel \xe0 projet","Accord cadre"],g=e=>{try{return new URL(e),!0}catch(e){return!1}};function x(){return(0,a.jsx)(l.default,{pageName:"ajouter-offre",children:(0,a.jsx)(c.default,{children:(0,a.jsx)(h,{})})})}function h(){let[e,r]=(0,n.useState)({intituleOffre:"",commentaire:"",pays:[],autrePays:"",bailleur:"",objectifs:"",profilExpert:"",montant:"",devise:"EUR",dureeMission:"",dateDepot:"",lienTDR:"",fichierTDR:null,heureDepot:"",nomSite:"",typeOffre:"",dateSoumissionValidation:new Date().toISOString().slice(0,10),offreTrouveePar:""}),[t,s]=(0,n.useState)(!1),[l,c]=(0,n.useState)(!1),[x,h]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=localStorage.getItem("user");if(e){let t=JSON.parse(e);r(e=>({...e,offreTrouveePar:t.prenom||t.name||"Utilisateur"}))}},[]);let f=e=>{let{name:t,value:a,type:s}=e.target;r(e=>({...e,[t]:a}))},b=async t=>{if(t.preventDefault(),!e.intituleOffre.trim())return void alert("Veuillez remplir l'intitul\xe9 de l'offre.");if(!e.bailleur.trim())return void alert("Veuillez remplir le bailleur.");if(!e.objectifs.trim())return void alert("Veuillez remplir les objectifs.");if(!e.dateDepot)return void alert("Veuillez s\xe9lectionner une date de d\xe9p\xf4t.");if(!e.typeOffre)return void alert("Veuillez s\xe9lectionner un type d'offre.");if(0===e.pays.length)return void alert("Veuillez s\xe9lectionner au moins un pays.");if(e.pays.includes("Autre")&&!e.autrePays.trim())return void alert('Veuillez pr\xe9ciser le nom du pays dans le champ "Autre".');let a=new Date;if(a.setHours(0,0,0,0),new Date(e.dateDepot)<a&&!confirm("La date de d\xe9p\xf4t est dans le pass\xe9. Voulez-vous continuer ?"))return;if(e.lienTDR.trim()&&!g(e.lienTDR))return void alert("Veuillez entrer une URL valide pour le lien TDR.");s(!0);try{let r={intitule_offre:e.intituleOffre,bailleur:e.bailleur,pays:e.pays.includes("Autre")?[...e.pays.filter(e=>"Autre"!==e),e.autrePays]:e.pays,date_depot:e.dateDepot,statut:"en_attente",commentaire:e.commentaire,montant:e.montant?parseFloat(e.montant):null,type_offre:e.typeOffre,lien_tdr:e.lienTDR||null,date_soumission_validation:e.dateSoumissionValidation||null},t=await d.sF.create(r);if(t.success)console.log("âœ… Offre cr\xe9\xe9e avec succ\xe8s dans la base de donn\xe9es:",t.data),s(!1),c(!0);else throw Error(t.error||"Erreur lors de la cr\xe9ation de l'offre")}catch(e){console.error("Erreur lors de l'ajout de l'offre:",e),alert("Une erreur est survenue lors de l'ajout de l'offre: ".concat(e.message,". Veuillez r\xe9essayer.")),s(!1);return}let i=localStorage.getItem("user"),n=i?JSON.parse(i):null;r({intituleOffre:"",commentaire:"",pays:[],autrePays:"",bailleur:"",objectifs:"",profilExpert:"",montant:"",devise:"EUR",dureeMission:"",dateDepot:"",lienTDR:"",fichierTDR:null,heureDepot:"",nomSite:"",typeOffre:"",dateSoumissionValidation:new Date().toISOString().slice(0,10),offreTrouveePar:(null==n?void 0:n.prenom)||(null==n?void 0:n.name)||"Utilisateur"}),h(""),setTimeout(()=>{c(!1)},3e3)};return(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white",children:[(0,a.jsx)("nav",{className:"bg-white/90 backdrop-blur-sm border-b border-blue-100 sticky top-0 z-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)(i(),{href:"/",children:(0,a.jsx)("img",{src:"https://static.readdy.ai/image/36ce116ccdb0d05752a287dd792317ce/3a2cd734c9129790560cc32a9975e166.jfif",alt:"BMS Logo",className:"h-10 cursor-pointer"})})}),(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-8",children:[(0,a.jsx)(o.default,{variant:"outline",size:"sm"}),(0,a.jsx)(i(),{href:"/dashboard",className:"text-gray-700 hover:text-blue-600 transition-colors cursor-pointer",children:"Dashboard"}),(0,a.jsx)(i(),{href:"/offres",className:"text-gray-700 hover:text-blue-600 transition-colors cursor-pointer",children:"Offres"})]})]})})}),(0,a.jsx)("div",{className:"max-w-3xl mx-auto py-12 px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl border border-blue-100 p-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("i",{className:"ri-add-circle-line text-2xl text-blue-600"})}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Ajouter une Nouvelle Offre"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Remplissez le formulaire pour cr\xe9er une nouvelle offre"})]}),l&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("i",{className:"ri-check-circle-line text-green-500 text-xl mr-3"}),(0,a.jsx)("p",{className:"text-green-700",children:"Offre ajout\xe9e avec succ\xe8s !"})]})}),(0,a.jsxs)("form",{onSubmit:b,className:"space-y-6",encType:"multipart/form-data",children:[(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intitul\xe9 de l'offre *"}),(0,a.jsx)("input",{type:"text",name:"intituleOffre",value:e.intituleOffre,onChange:f,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Ex: D\xe9veloppement application mobile"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Offre trouv\xe9e par *"}),(0,a.jsx)("input",{type:"text",name:"offreTrouveePar",value:e.offreTrouveePar,readOnly:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 text-sm cursor-not-allowed",placeholder:"Chargement..."}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Rempli automatiquement avec votre nom"})]})]}),(0,a.jsx)("div",{className:"grid md:grid-cols-2 gap-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaire"}),(0,a.jsx)("input",{type:"text",name:"commentaire",value:e.commentaire,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Commentaire..."})]})}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Pays *"}),(0,a.jsxs)("div",{className:"relative mb-2",children:[(0,a.jsx)("input",{type:"text",placeholder:"Rechercher un pays...",value:x,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"}),x&&(0,a.jsx)("button",{onClick:()=>h(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:"âœ•"})]}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto border border-gray-300 rounded-lg bg-white",children:(0,a.jsx)("div",{className:"grid grid-cols-1",children:u.filter(e=>e.toLowerCase().includes(x.toLowerCase())).map(t=>(0,a.jsxs)("label",{className:"flex items-center space-x-2 cursor-pointer hover:bg-gray-50 p-3 border-b border-gray-100 last:border-b-0",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.pays.includes(t),onChange:()=>{r(e=>({...e,pays:e.pays.includes(t)?e.pays.filter(e=>e!==t):[...e.pays,t]}))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),(0,a.jsx)("span",{className:"text-sm text-gray-700 flex-1",children:t})]},t))})}),e.pays.length>0&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-green-50 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-sm text-green-700 font-medium",children:["Pays s\xe9lectionn\xe9s (",e.pays.length,") :"]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:e.pays.map(t=>(0,a.jsxs)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs flex items-center gap-1",children:["Autre"===t?"".concat(t,": ").concat(e.autrePays||"Non sp\xe9cifi\xe9"):t,(0,a.jsx)("button",{onClick:()=>{r(e=>({...e,pays:e.pays.filter(e=>e!==t),autrePays:"Autre"===t?"":e.autrePays}))},className:"ml-1 text-green-600 hover:text-green-800",children:"âœ•"})]},t))})]}),e.pays.includes("Autre")&&(0,a.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-blue-800 mb-2",children:"Pr\xe9cisez le pays *"}),(0,a.jsx)("input",{type:"text",name:"autrePays",value:e.autrePays,onChange:f,required:e.pays.includes("Autre"),className:"w-full px-3 py-2 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Entrez le nom du pays...",maxLength:100}),(0,a.jsx)("p",{className:"text-xs text-blue-600 mt-1",children:"Veuillez pr\xe9ciser le nom du pays qui n'est pas dans la liste (max 100 caract\xe8res)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bailleur *"}),(0,a.jsx)("input",{type:"text",name:"bailleur",value:e.bailleur,onChange:f,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Nom du bailleur"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objectifs *"}),(0,a.jsx)("textarea",{name:"objectifs",value:e.objectifs,onChange:f,required:!0,rows:2,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Objectifs de la mission..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profil d'expert"}),(0,a.jsx)("input",{type:"text",name:"profilExpert",value:e.profilExpert,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Profil recherch\xe9..."})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Montant"}),(0,a.jsx)("input",{type:"number",name:"montant",value:e.montant,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Montant..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Devise"}),(0,a.jsx)("select",{name:"devise",value:e.devise,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:m.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dur\xe9e de la mission"}),(0,a.jsx)("input",{type:"text",name:"dureeMission",value:e.dureeMission,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Ex: 6 mois"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de d\xe9p\xf4t *"}),(0,a.jsx)("input",{type:"date",name:"dateDepot",value:e.dateDepot,onChange:f,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Heure de d\xe9p\xf4t"}),(0,a.jsx)("input",{type:"time",name:"heureDepot",value:e.heureDepot,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Optionnel - Laissez vide si l'heure n'est pas sp\xe9cifi\xe9e"})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Lien TDR"}),(0,a.jsx)("input",{type:"url",name:"lienTDR",value:e.lienTDR,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"https://..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier TDR (PDF, Word...)"}),(0,a.jsx)("input",{type:"file",name:"fichierTDR",accept:".pdf,.doc,.docx,.odt,.txt,.rtf,.xls,.xlsx,.csv,.ppt,.pptx,.zip,.rar,.7z,.jpg,.jpeg,.png",onChange:e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];if(t.size>0xa00000){alert("Le fichier est trop volumineux. La taille maximale autoris\xe9e est de 10MB."),e.target.value="";return}if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.oasis.opendocument.text","text/plain","application/rtf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/zip","application/x-rar-compressed","application/x-7z-compressed","image/jpeg","image/png"].includes(t.type)){alert("Type de fichier non autoris\xe9. Veuillez s\xe9lectionner un fichier PDF, Word, Excel, PowerPoint, image ou archive."),e.target.value="";return}r(e=>({...e,fichierTDR:t}))}},className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"}),e.fichierTDR&&(0,a.jsx)("span",{className:"text-xs text-gray-500 mt-1 block",children:e.fichierTDR.name})]})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nom du site"}),(0,a.jsx)("input",{type:"text",name:"nomSite",value:e.nomSite,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",placeholder:"Nom du site..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type d'offre *"}),(0,a.jsxs)("select",{name:"typeOffre",value:e.typeOffre,onChange:f,required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm",children:[(0,a.jsx)("option",{value:"",children:"S\xe9lectionner"}),p.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date de soumission pour validation"}),(0,a.jsx)("input",{type:"date",name:"dateSoumissionValidation",value:e.dateSoumissionValidation,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 text-sm"})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 pt-6",children:[(0,a.jsx)("button",{type:"submit",disabled:t,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white px-8 py-3 rounded-lg font-semibold transition-colors cursor-pointer whitespace-nowrap",children:t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Ajout en cours..."]}):(0,a.jsx)(a.Fragment,{children:"Ajouter l'offre"})}),(0,a.jsx)(i(),{href:"/offres",className:"border-2 border-gray-300 hover:bg-gray-50 text-gray-700 px-8 py-3 rounded-lg font-semibold transition-colors text-center cursor-pointer whitespace-nowrap",children:"Annuler"})]})]})]})})]})}},63925:(e,r,t)=>{"use strict";t.d(r,{H2:()=>u,R2:()=>m,sF:()=>p,dR:()=>g,c9:()=>x});var a=function(e){return e.DEBUG="DEBUG",e.INFO="INFO",e.WARN="WARN",e.ERROR="ERROR",e.CRITICAL="CRITICAL",e}({});class s{formatMessage(e){let r=new Date(e.timestamp).toLocaleTimeString(),t=e.context?"[".concat(e.context,"]"):"",a="[".concat(e.level,"]"),s="".concat(r," ").concat(a," ").concat(t," ").concat(e.message);return e.data&&(s+=" | Data: ".concat(JSON.stringify(e.data))),e.error&&(s+=" | Error: ".concat(e.error.message),e.error.stack&&(s+=" | Stack: ".concat(e.error.stack))),s}addLog(e){if(this.logs.push(e),this.logs.length>this.maxLogs&&(this.logs=this.logs.slice(-this.maxLogs)),this.isDevelopment){let r=this.formatMessage(e);switch(e.level){case"DEBUG":console.debug(r);break;case"INFO":console.info(r);break;case"WARN":console.warn(r);break;case"ERROR":case"CRITICAL":console.error(r)}}!this.isDevelopment&&e.level>="ERROR"&&this.sendToMonitoring(e)}async sendToMonitoring(e){try{{let r=JSON.parse(localStorage.getItem("bms_monitoring_logs")||"[]");r.push(e),localStorage.setItem("bms_monitoring_logs",JSON.stringify(r.slice(-100)))}}catch(e){console.error("Erreur lors de l'envoi au monitoring:",e)}}debug(e,r,t){this.addLog({level:"DEBUG",message:e,context:r,data:t,timestamp:new Date().toISOString()})}info(e,r,t){this.addLog({level:"INFO",message:e,context:r,data:t,timestamp:new Date().toISOString()})}warn(e,r,t){this.addLog({level:"WARN",message:e,context:r,data:t,timestamp:new Date().toISOString()})}error(e,r,t,a){this.addLog({level:"ERROR",message:e,error:r,context:t,data:a,timestamp:new Date().toISOString()})}critical(e,r,t,a){this.addLog({level:"CRITICAL",message:e,error:r,context:t,data:a,timestamp:new Date().toISOString()})}apiError(e,r,t,a){this.error("Erreur API sur ".concat(e),r,"API",{endpoint:e,status:null==t?void 0:t.status,statusText:null==t?void 0:t.statusText,url:null==t?void 0:t.url,data:a})}dashboardError(e,r,t,a){this.error("Erreur Dashboard: ".concat(e),r,"Dashboard",{operation:e,filters:t,data:a})}authError(e,r,t){this.error("Erreur Auth: ".concat(e),r,"Auth",t)}getRecentLogs(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,t=this.logs;return e&&(t=t.filter(r=>r.level===e)),t.slice(-r)}exportLogs(){return JSON.stringify(this.logs,null,2)}clearLogs(){this.logs=[]}getLogStats(){let e={total:this.logs.length,byLevel:{},recentErrors:this.logs.filter(e=>e.level>="ERROR").slice(-10)};return Object.values(a).forEach(r=>{e.byLevel[r]=this.logs.filter(e=>e.level===r).length}),e}constructor(){this.logs=[],this.maxLogs=1e3,this.isDevelopment=!1}}let i=new s,n=(e,r,t)=>i.info(e,r,t),o=(e,r,t)=>i.warn(e,r,t),l=(e,r,t,a)=>i.error(e,r,t,a);var c=t(94089);let d={BASE_URL:"http://localhost:5000",NODE_ENV:"production",APP_NAME:c.env.NEXT_PUBLIC_APP_NAME||"BMS",APP_VERSION:c.env.NEXT_PUBLIC_APP_VERSION||"1.0.0",REQUEST_TIMEOUT:1e4,MAX_RETRIES:3,RETRY_DELAY:1e3}.BASE_URL;n("Configuration: NEXT_PUBLIC_API_URL=".concat("http://localhost:5000"),"API"),n("URL de base utilis\xe9e: ".concat(d),"API");let u=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat(d).concat(e),a=localStorage.getItem("token");n("Appel vers: ".concat(t),"API"),n("Token pr\xe9sent: ".concat(a?"OUI":"NON"),"API"),a&&(n("Token (premiers caract\xe8res): ".concat(a.substring(0,20),"..."),"API"),n("Longueur du token: ".concat(a.length),"API"));let s={headers:{"Content-Type":"application/json",...a&&{Authorization:"Bearer ".concat(a)},...r.headers},...r};try{let r;n("Envoi de la requ\xeate vers: ".concat(t),"API");let a=await fetch(t,s);if(n("R\xe9ponse re\xe7ue: ".concat(a.status," ").concat(a.statusText),"API"),n("Headers de r\xe9ponse: ".concat(JSON.stringify(Object.fromEntries(a.headers.entries()))),"API"),!a.ok){let r={};try{r=await a.json()}catch(e){o("Impossible de parser le body d'erreur: ".concat(e instanceof Error?e.message:String(e)),"API"),r={error:"Erreur HTTP ".concat(a.status,": ").concat(a.statusText)}}if(i.apiError(e,Error("HTTP ".concat(a.status,": ").concat(a.statusText)),a,{status:a.status,statusText:a.statusText,url:t,errorData:r,headers:Object.fromEntries(a.headers.entries())}),401===a.status)throw i.authError("Token invalide",Error(r.error||"Token expir\xe9 ou invalide"),r),localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),n("Token invalide supprim\xe9 du localStorage","API"),"/login"!==window.location.pathname&&(n("Redirection vers /login","API"),window.location.href="/login"),Error("Token invalide - Redirection vers la connexion");let s=r.error||r.message||"Erreur HTTP ".concat(a.status,": ").concat(a.statusText);throw Error(s)}try{r=await a.json(),n("Succ\xe8s: ".concat(e),"API",r)}catch(e){throw l("Erreur lors du parsing de la r\xe9ponse: ".concat(e instanceof Error?e.message:String(e)),e instanceof Error?e:Error(String(e)),"API"),Error("Erreur lors du parsing de la r\xe9ponse: ".concat(e instanceof Error?e.message:String(e)))}return r}catch(a){if(i.apiError(e,a instanceof Error?a:Error(String(a)),void 0,{url:t,timestamp:new Date().toISOString()}),(a instanceof Error?a.message:String(a))==="Token invalide - Redirection vers la connexion")throw a;let r="Erreur lors de la r\xe9cup\xe9ration des donn\xe9es: ".concat(a instanceof Error?a.message:String(a));throw e.includes("/performance/")&&(r="Impossible de charger les donn\xe9es de performance. V\xe9rifiez votre connexion et r\xe9essayez."),l("Message d'erreur am\xe9lior\xe9: ".concat(r),a instanceof Error?a:Error(String(a)),"API"),Error(r)}},m={login:async e=>u("/api/auth/login",{method:"POST",body:JSON.stringify(e)}),logout:async()=>(localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("userRole"),{success:!0,message:"D\xe9connexion r\xe9ussie"}),register:async e=>u("/api/auth/register",{method:"POST",body:JSON.stringify(e)}),verifyToken:async()=>u("/api/auth/verify")},p={getAll:async()=>u("/api/offres"),create:async e=>u("/api/offres",{method:"POST",body:JSON.stringify(e)}),update:async(e,r)=>u("/api/offres/".concat(e),{method:"PUT",body:JSON.stringify(r)}),delete:async e=>u("/api/offres/".concat(e),{method:"DELETE"}),validate:async(e,r)=>u("/api/offres/".concat(e,"/validate"),{method:"PATCH",body:JSON.stringify(r)})},g={getOverview:async(e,r)=>{let t=e&&r?"?startDate=".concat(e,"&endDate=").concat(r):"";return u("/api/performance/overview".concat(t))},getPoles:async(e,r)=>{let t=e&&r?"?startDate=".concat(e,"&endDate=").concat(r):"";return u("/api/performance/poles".concat(t))},getPolesDetailed:async(e,r)=>{let t=e&&r?"?startDate=".concat(e,"&endDate=").concat(r):"";return u("/api/performance/poles-detailed".concat(t))},getTrends:async()=>u("/api/performance/trends"),getCommerciaux:async(e,r)=>{let t=e&&r?"?startDate=".concat(e,"&endDate=").concat(r):"";return u("/api/performance/commerciaux".concat(t))},getMetrics:async()=>u("/api/performance/metrics")},x={getAll:async e=>u("/api/scheduled-searches?userId=".concat(e)),getOptions:async()=>u("/api/scheduled-searches/options"),create:async e=>u("/api/scheduled-searches",{method:"POST",body:JSON.stringify(e)}),update:async e=>u("/api/scheduled-searches",{method:"PUT",body:JSON.stringify(e)}),delete:async e=>u("/api/scheduled-searches",{method:"DELETE",body:JSON.stringify(e)}),getSavedKeywords:async e=>u("/api/scheduled-searches/saved-keywords?userId=".concat(e)),saveKeywords:async e=>u("/api/scheduled-searches/saved-keywords",{method:"POST",body:JSON.stringify(e)}),deleteSavedKeywords:async(e,r)=>u("/api/scheduled-searches/saved-keywords/".concat(e),{method:"DELETE",body:JSON.stringify({userId:r})}),getSearchStats:async e=>u("/api/scheduled-searches/search-stats".concat(e?"?userId=".concat(e):""))}}},e=>{var r=r=>e(e.s=r);e.O(0,[255,458,530,347,870,358],()=>r(30094)),_N_E=e.O()}]);