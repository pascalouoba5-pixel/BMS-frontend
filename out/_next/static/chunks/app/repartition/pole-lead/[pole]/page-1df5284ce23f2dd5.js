(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[371],{13316:(e,t,s)=>{Promise.resolve().then(s.bind(s,49172)),Promise.resolve().then(s.bind(s,150)),Promise.resolve().then(s.bind(s,84857)),Promise.resolve().then(s.bind(s,42770))},21332:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(1521);let a=()=>{let[e,t]=(0,r.useState)({token:null,user:null,isAuthenticated:!1,userRole:null});(0,r.useEffect)(()=>{let e=localStorage.getItem("token"),s=localStorage.getItem("user");if(e&&s){let r=JSON.parse(s);t({token:e,user:r,isAuthenticated:!0,userRole:r.role||null})}},[]);let s=(0,r.useCallback)((e,s)=>{localStorage.setItem("token",e),localStorage.setItem("user",JSON.stringify(s)),t({token:e,user:s,isAuthenticated:!0,userRole:s.role||null})},[]),a=(0,r.useCallback)(()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),t({token:null,user:null,isAuthenticated:!1,userRole:null})},[]),l=(0,r.useCallback)(e=>{localStorage.setItem("token",e),t(t=>({...t,token:e}))},[]);return{...e,login:s,logout:a,updateToken:l}}},49172:(e,t,s)=>{"use strict";s.d(t,{default:()=>m});var r=s(73365),a=s(1521),l=s(42770);function i(e){let{offres:t,loading:s,poleName:l,onViewOffre:i,onDeleteOffre:n,onDownloadTDR:c,searchTerm:o="",sortBy:d="dateDepot",sortOrder:x="desc",onSort:m,selectedModalite:u="all",className:p=""}=e,[h,f]=(0,a.useState)([]);(0,a.useEffect)(()=>{g()},[t,o,u]);let g=()=>{let e=[...t];if(o){let t=o.toLowerCase();e=e.filter(e=>{let s=(e.intituleOffre||e.titre||"").toLowerCase(),r=(e.bailleur||e.client||"").toLowerCase(),a=(e.pays||[]).join(" ").toLowerCase();return s.includes(t)||r.includes(t)||a.includes(t)})}u&&"all"!==u&&(e=e.filter(e=>e.modalite===u)),f(e)},b=e=>{switch(e){case"Strat\xe9gique":return"bg-purple-100 text-purple-800";case"Priorit\xe9 haute":return"bg-red-100 text-red-800";case"Opportunit\xe9 interm\xe9diaire":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}},j=e=>{switch(e){case"gagn\xe9":return"bg-green-100 text-green-800";case"d\xe9pos\xe9e":return"bg-blue-100 text-blue-800";case"mont\xe9e":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},y=e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},N=e=>e&&0!==e.length?e.join(", "):"Non sp\xe9cifi\xe9",v=e=>e?new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"}):"Non sp\xe9cifi\xe9e",w=e=>e?e.replace("€"," €"):"Non sp\xe9cifi\xe9",D=e=>{m&&m(e)};return s?(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden ".concat(p),children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),(0,r.jsx)("div",{className:"space-y-3",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded"},t))})]})})}):(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden ".concat(p),children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-building-line text-blue-600 mr-2"}),"Offres du ",l]}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:[h.length," offre",h.length>1?"s":""," trouv\xe9e",h.length>1?"s":""]})]}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-refresh-line"}),"Rafra\xeechir"]})})]})}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>D("intituleOffre"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-file-text-line"}),"Intitul\xe9 Offre","intituleOffre"===d&&(0,r.jsx)("i",{className:"ri-arrow-".concat("asc"===x?"up":"down","-line")})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>D("bailleur"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-building-line"}),"Bailleur","bailleur"===d&&(0,r.jsx)("i",{className:"ri-arrow-".concat("asc"===x?"up":"down","-line")})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-map-pin-line"}),"Pays"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-money-dollar-circle-line"}),"Montant"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>D("priorite"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-flag-line"}),"Priorit\xe9","priorite"===d&&(0,r.jsx)("i",{className:"ri-arrow-".concat("asc"===x?"up":"down","-line")})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>D("modalite"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line"}),"Modalit\xe9","modalite"===d&&(0,r.jsx)("i",{className:"ri-arrow-".concat("asc"===x?"up":"down","-line")})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>D("dateDepot"),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-calendar-line"}),"Date D\xe9p\xf4t","dateDepot"===d&&(0,r.jsx)("i",{className:"ri-arrow-".concat("asc"===x?"up":"down","-line")})]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-file-download-line"}),"TDR"]})}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line"}),"Actions"]})})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===h.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:9,className:"px-6 py-12 text-center text-gray-500",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium",children:"Aucune offre trouv\xe9e"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:o?"Aucune offre ne correspond \xe0 votre recherche.":"Aucune offre attribu\xe9e au ".concat(l,".")})]})})}):h.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 max-w-xs truncate",children:e.intituleOffre||e.titre||"Sans titre"}),e.statut&&(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border mt-1 ".concat(y(e.statut)),children:"approuv\xe9e"===e.statut?"Approuv\xe9e":"rejet\xe9e"===e.statut?"Rejet\xe9e":"en_attente"===e.statut?"En attente":"Brouillon"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900 max-w-xs truncate",children:N(e.pays)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:w(e.montant||e.budget)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.priorite?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(b(e.priorite)),children:e.priorite}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non d\xe9finie"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.modalite?(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(j(e.modalite)),children:e.modalite}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non sp\xe9cifi\xe9e"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:v(e.dateDepot)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.tdrFile||e.lienTDR?(0,r.jsxs)("button",{onClick:()=>c&&c(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-download-line"}),"T\xe9l\xe9charger"]}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Non disponible"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[i&&(0,r.jsxs)("button",{onClick:()=>i(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-eye-line"}),"Voir"]}),n&&(0,r.jsxs)("button",{onClick:()=>n(e),className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs transition-colors flex items-center gap-1",children:[(0,r.jsx)("i",{className:"ri-close-line"}),"Annuler"]})]})})]},e.id))})]})})]})}var n=s(57964),c=s(98809),o=s(21332);function d(e){let{offreId:t,onFichiersUpdate:s}=e,[l,i]=(0,a.useState)([]),[n,c]=(0,a.useState)(!1),[d,x]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),[p,h]=(0,a.useState)(""),[f,g]=(0,a.useState)("1.0"),[b,j]=(0,a.useState)(!1),{token:y}=(0,o.A)();(0,a.useEffect)(()=>{N()},[t]);let N=async()=>{if(y){c(!0);try{let e=await fetch("/api/fichiers-tdr/offre/".concat(t),{headers:{Authorization:"Bearer ".concat(y)}});if(e.ok){let t=await e.json();i(t.fichiers||[])}else console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers TDR")}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers TDR:",e)}finally{c(!1)}}},v=async()=>{if(m&&y){x(!0);try{let e=new FormData;e.append("fichier",m),e.append("description",p),e.append("version",f);let r=await fetch("/api/fichiers-tdr/upload/".concat(t),{method:"POST",headers:{Authorization:"Bearer ".concat(y)},body:e});if(r.ok)await r.json(),alert("Fichier TDR upload\xe9 avec succ\xe8s !"),u(null),h(""),g("1.0"),j(!1),N(),s&&s();else{let e=await r.json();alert("Erreur lors de l'upload: ".concat(e.error))}}catch(e){console.error("Erreur lors de l'upload:",e),alert("Erreur lors de l'upload du fichier")}finally{x(!1)}}},w=async(e,t)=>{if(y)try{let s=await fetch("/api/fichiers-tdr/download/".concat(e),{headers:{Authorization:"Bearer ".concat(y)}});if(s.ok){let e=await s.blob(),r=window.URL.createObjectURL(e),a=document.createElement("a");a.href=r,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(r),document.body.removeChild(a)}else alert("Erreur lors du t\xe9l\xe9chargement du fichier")}catch(e){console.error("Erreur lors du t\xe9l\xe9chargement:",e),alert("Erreur lors du t\xe9l\xe9chargement du fichier")}},D=async e=>{if(y&&confirm("\xcates-vous s\xfbr de vouloir supprimer ce fichier TDR ?"))try{(await fetch("/api/fichiers-tdr/".concat(e),{method:"DELETE",headers:{Authorization:"Bearer ".concat(y)}})).ok?(alert("Fichier TDR supprim\xe9 avec succ\xe8s !"),N(),s&&s()):alert("Erreur lors de la suppression du fichier")}catch(e){console.error("Erreur lors de la suppression:",e),alert("Erreur lors de la suppression du fichier")}},k=e=>{if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]},C=e=>e.includes("pdf")?"ri-file-pdf-line text-red-500":e.includes("word")?"ri-file-word-line text-blue-500":e.includes("excel")?"ri-file-excel-line text-green-500":"ri-file-line text-gray-500";return n?(0,r.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,r.jsx)("span",{className:"ml-2 text-gray-600",children:"Chargement des fichiers TDR..."})]}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line text-blue-600 mr-2"}),"Fichiers TDR (",l.length,")"]}),(0,r.jsxs)("button",{onClick:()=>j(!b),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:[(0,r.jsx)("i",{className:"ri-upload-line"}),b?"Masquer":"Ajouter un fichier"]})]}),b&&(0,r.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier TDR *"}),(0,r.jsx)("input",{type:"file",onChange:e=>{var t;let s=null==(t=e.target.files)?void 0:t[0];if(s){if(s.size>0xa00000)return void alert("Le fichier est trop volumineux. Taille maximum : 10MB");if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(s.type))return void alert("Type de fichier non support\xe9. Seuls les fichiers PDF, Word et Excel sont accept\xe9s.");u(s)}},accept:".pdf,.doc,.docx,.xls,.xlsx",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"PDF, Word, Excel - Max 10MB"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),(0,r.jsx)("input",{type:"text",value:p,onChange:e=>h(e.target.value),placeholder:"Description du fichier",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Version"}),(0,r.jsx)("input",{type:"text",value:f,onChange:e=>g(e.target.value),placeholder:"1.0",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-4",children:[(0,r.jsx)("button",{onClick:()=>j(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Annuler"}),(0,r.jsx)("button",{onClick:v,disabled:!m||d,className:"bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2",children:d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Upload en cours..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"ri-upload-line"}),"Uploader"]})})]})]}),0===l.length?(0,r.jsxs)("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-file-line text-2xl text-gray-400"})}),(0,r.jsx)("p",{className:"text-gray-600",children:"Aucun fichier TDR disponible"}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Ajoutez des fichiers TDR pour cette offre"})]}):(0,r.jsx)("div",{className:"space-y-3",children:l.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white rounded-lg border border-gray-200 hover:border-blue-300 transition-colors",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,r.jsx)("i",{className:"text-xl ".concat(C(e.type_mime))})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-gray-900",children:e.nom_fichier}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[(0,r.jsx)("span",{children:k(e.taille)}),(0,r.jsxs)("span",{children:["Version ",e.version]}),(0,r.jsx)("span",{children:new Date(e.date_upload).toLocaleDateString("fr-FR")}),e.description&&(0,r.jsx)("span",{className:"text-gray-600",children:e.description})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("button",{onClick:()=>w(e.id,e.nom_fichier),className:"text-blue-600 hover:text-blue-800 p-2 rounded-lg hover:bg-blue-50 transition-colors",title:"T\xe9l\xe9charger",children:(0,r.jsx)("i",{className:"ri-download-line text-lg"})}),(0,r.jsx)("button",{onClick:()=>D(e.id),className:"text-red-600 hover:text-red-800 p-2 rounded-lg hover:bg-red-50 transition-colors",title:"Supprimer",children:(0,r.jsx)("i",{className:"ri-delete-bin-line text-lg"})})]})]},e.id))})]})}var x=s(63925);function m(e){let{poleName:t}=e;return(0,r.jsx)(l.default,{pageName:"pole-lead",children:(0,r.jsx)(u,{poleName:t})})}function u(e){let{poleName:t}=e,[s,l]=(0,a.useState)([]),[o,m]=(0,a.useState)([]),[u,p]=(0,a.useState)([]),[h,f]=(0,a.useState)(!0),[g,b]=(0,a.useState)({}),[j,y]=(0,a.useState)(""),[N,v]=(0,a.useState)("dateDepot"),[w,D]=(0,a.useState)("desc"),[k,C]=(0,a.useState)("all"),[S,A]=(0,a.useState)("table"),[O,T]=(0,a.useState)(!1),[R,E]=(0,a.useState)(!1),[M,L]=(0,a.useState)(null);(0,a.useEffect)(()=>{q()},[t]),(0,a.useEffect)(()=>{let e=()=>{q()};return window.addEventListener("offresUpdated",e),()=>{window.removeEventListener("offresUpdated",e)}},[]);let q=()=>{f(!0);try{let e=localStorage.getItem("offres");if(e){let s=JSON.parse(e),r=s.filter(e=>e.poleLead===t&&"approuv\xe9e"===e.statut),a=s.filter(e=>"approuv\xe9e"===e.statut&&e.poleAssocies&&e.poleAssocies.includes(t)),i=r.sort((e,t)=>{let s=e.dateDepot?new Date(e.dateDepot).getTime():0;return(t.dateDepot?new Date(t.dateDepot).getTime():0)-s}),n=a.sort((e,t)=>{let s=e.dateDepot?new Date(e.dateDepot).getTime():0;return(t.dateDepot?new Date(t.dateDepot).getTime():0)-s});m(i),p(n),l([...i,...n]),I([...i,...n]),[...i,...n].forEach(e=>{B(e.id,0)})}}catch(e){console.error("Erreur lors du chargement des offres:",e)}finally{f(!1)}},I=async e=>{if(e.length)try{let s=localStorage.getItem("token");if(!s)return;let r={};for(let a of e)try{let e=await fetch("/api/fichiers-tdr/offre/".concat(a.id),{headers:{Authorization:"Bearer ".concat(s)}});if(e.ok){var t;let s=await e.json();r[a.id]=(null==(t=s.fichiers)?void 0:t.length)||0}else r[a.id]=0}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des fichiers TDR pour l'offre ".concat(a.id,":"),e),r[a.id]=0}b(r)}catch(e){console.error("Erreur lors de la r\xe9cup\xe9ration des compteurs TDR:",e)}},B=(e,t)=>{b(s=>({...s,[e]:t}))},P=e=>{N===e?D("asc"===w?"desc":"asc"):(v(e),D("desc"))},F=async e=>{console.log("T\xe9l\xe9chargement TDR g\xe9r\xe9 par TDRManager pour l'offre:",e.id)},_=e=>{L(e),E(!0)},V=e=>{if(confirm("\xcates-vous s\xfbr de vouloir annuler l'offre \"".concat(e.intituleOffre||e.titre,'" ?')))try{let s=localStorage.getItem("offres");if(s){let r=JSON.parse(s).map(t=>t.id===e.id?{...t,statut:"rejet\xe9e",modalite:"annul\xe9e"}:t);localStorage.setItem("offres",JSON.stringify(r)),l(r.filter(e=>e.poleLead===t)),alert("Offre annul\xe9e avec succ\xe8s")}}catch(e){console.error("Erreur lors de l'annulation:",e),alert("Erreur lors de l'annulation de l'offre")}},U=e=>{if(confirm("Marquer l'offre \"".concat(e.intituleOffre||e.titre,'" comme mont\xe9e ?')))try{let s=localStorage.getItem("offres");if(s){let r=JSON.parse(s).map(t=>t.id===e.id?{...t,modalite:"mont\xe9e"}:t);localStorage.setItem("offres",JSON.stringify(r)),l(r.filter(e=>e.poleLead===t)),alert("Offre marqu\xe9e comme mont\xe9e avec succ\xe8s")}}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},z=async e=>{if(confirm("Marquer l'offre \"".concat(e.intituleOffre||e.titre,'" comme d\xe9pos\xe9e ?')))try{let r=await x.sF.update(e.id,{modalite:"d\xe9pos\xe9e",offreDeposee:!0});if(r.success){let r=s.map(t=>t.id===e.id?{...t,modalite:"d\xe9pos\xe9e",offreDeposee:!0}:t);l(r.filter(e=>e.poleLead===t)),alert("Offre marqu\xe9e comme d\xe9pos\xe9e avec succ\xe8s")}else throw Error(r.error||"Erreur lors de la mise \xe0 jour")}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},J=async e=>{if(confirm("Marquer l'offre \"".concat(e.intituleOffre||e.titre,'" comme gagn\xe9e ?')))try{let r=await x.sF.update(e.id,{modalite:"gagn\xe9",statutOffre:"Gagn\xe9e"});if(r.success){let r=s.map(t=>t.id===e.id?{...t,modalite:"gagn\xe9",statutOffre:"Gagn\xe9e"}:t);l(r.filter(e=>e.poleLead===t)),alert("Offre marqu\xe9e comme gagn\xe9e avec succ\xe8s")}else throw Error(r.error||"Erreur lors de la mise \xe0 jour")}catch(e){console.error("Erreur lors du marquage:",e),alert("Erreur lors du marquage de l'offre")}},G=e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},W=e=>e?new Date(e).toLocaleDateString("fr-FR"):"Non sp\xe9cifi\xe9e",K=e=>e&&0!==e.length?e.join(", "):"Non sp\xe9cifi\xe9",H=o.filter(e=>{let t=!j||(e.intituleOffre||e.titre||"").toLowerCase().includes(j.toLowerCase())||(e.bailleur||e.client||"").toLowerCase().includes(j.toLowerCase())||(e.pays||[]).join(" ").toLowerCase().includes(j.toLowerCase()),s="all"===k||e.modalite===k;return t&&s}),Q=u.filter(e=>{let t=!j||(e.intituleOffre||e.titre||"").toLowerCase().includes(j.toLowerCase())||(e.bailleur||e.client||"").toLowerCase().includes(j.toLowerCase())||(e.pays||[]).join(" ").toLowerCase().includes(j.toLowerCase()),s="all"===k||e.modalite===k;return t&&s}),X=[...H,...Q],Y=e=>{let{offre:t}=e;return(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 mt-4",children:[(0,r.jsxs)("button",{onClick:()=>U(t),className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("mont\xe9e"===t.modalite?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 hover:bg-green-50 border border-gray-300"),title:"Marquer comme mont\xe9e",children:[(0,r.jsx)("i",{className:"ri-check-line mr-1"}),"Mont\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>z(t),className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("d\xe9pos\xe9e"===t.modalite?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-yellow-50 border border-gray-300"),title:"Marquer comme d\xe9pos\xe9e",children:[(0,r.jsx)("i",{className:"ri-send-plane-line mr-1"}),"D\xe9pos\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>J(t),className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("gagn\xe9"===t.modalite?"bg-purple-100 text-purple-800 border border-purple-300":"bg-gray-100 text-gray-700 hover:bg-purple-50 border border-gray-300"),title:"Marquer comme gagn\xe9e",children:[(0,r.jsx)("i",{className:"ri-trophy-line mr-1"}),"Gagn\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>V(t),className:"px-3 py-1 text-xs font-medium rounded-full transition-colors ".concat("annul\xe9e"===t.modalite?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-700 hover:bg-red-50 border border-gray-300"),title:"Annuler l'offre",children:[(0,r.jsx)("i",{className:"ri-close-line mr-1"}),"Annuler"]})]})},Z=()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:[(0,r.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line text-blue-600 mr-2"}),"Modalit\xe9s de R\xe9partition - ",t]}),(0,r.jsx)("p",{className:"text-gray-600 mt-1",children:"Tableau complet des modalit\xe9s renseign\xe9es dans le formulaire de gestion de r\xe9partition"})]}),(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Offre"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bailleur"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pays"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Secteurs"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Diligences"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Clarifications"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"D\xe9lais"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Montage"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"P\xf4les"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Administratif"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Budget"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:X.map(e=>(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.intituleOffre||e.titre||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:e.commentaire&&e.commentaire.length>50?"".concat(e.commentaire.substring(0,50),"..."):e.commentaire})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:K(e.pays)}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.objectifs||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.diligencesMenees||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.adresseDemandeClarifications||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{children:["Clarification: ",W(e.delaiDemandeClarification)]}),(0,r.jsxs)("div",{children:["R\xe9ception: ",W(e.delaiAccuseReception)]}),(0,r.jsxs)("div",{children:["Intention: ",W(e.delaiIntentionSoumission)]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.chargeMontageAdministratif||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{className:"font-medium",children:["Lead: ",e.poleLead||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:["Associ\xe9s: ",e.poleAssocies||"Non attribu\xe9"]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,r.jsxs)("div",{children:["Transmission: ",W(e.delaiTransmissionMontageAdministratif)]}),(0,r.jsxs)("div",{children:["D\xe9p\xf4t: ",W(e.delaiDepot)]}),(0,r.jsxs)("div",{children:["D\xe9pos\xe9e: ",e.offreDeposee?"Oui":"Non"]}),e.chargeMontageAdministratif&&(0,r.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["Charg\xe9: ",e.chargeMontageAdministratif]})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(G(e.statut||"")),children:e.statutOffre||e.statut||"Non sp\xe9cifi\xe9"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.montant&&e.devise?"".concat(e.montant," ").concat(e.devise):"Non sp\xe9cifi\xe9"}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)("button",{onClick:()=>_(e),className:"text-blue-600 hover:text-blue-900",title:"Voir les d\xe9tails",children:(0,r.jsx)("i",{className:"ri-eye-line"})}),(0,r.jsx)("button",{onClick:()=>F(e),className:"text-purple-600 hover:text-purple-900",title:"T\xe9l\xe9charger TDR",children:(0,r.jsx)("i",{className:"ri-download-line"})})]})})]},e.id))})]})})]}),$=()=>(0,r.jsx)("div",{className:"grid gap-6",children:X.map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-lg font-bold text-gray-900",children:e.intituleOffre||e.titre||"Non sp\xe9cifi\xe9"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.bailleur||e.client||"Non sp\xe9cifi\xe9"})]}),(0,r.jsx)("span",{className:"inline-flex px-3 py-1 text-sm font-semibold rounded-full ".concat(G(e.statut||"")),children:e.statutOffre||e.statut||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"Informations de base"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Pays:"})," ",K(e.pays)]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Secteurs:"})," ",e.objectifs||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Budget:"})," ",e.montant&&e.devise?"".concat(e.montant," ").concat(e.devise):"Non sp\xe9cifi\xe9"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"Diligences et clarifications"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Diligences:"})," ",e.diligencesMenees||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Clarifications:"})," ",e.adresseDemandeClarifications||"Non sp\xe9cifi\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"D\xe9lai clarif.:"})," ",W(e.delaiDemandeClarification)]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h5",{className:"font-semibold text-gray-900 mb-2",children:"P\xf4les et montage"}),(0,r.jsxs)("div",{className:"space-y-1 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"P\xf4le Lead:"})," ",e.poleLead||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"P\xf4le Associ\xe9s:"})," ",e.poleAssocies||"Non attribu\xe9"]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"font-medium",children:"Charge montage:"})," ",e.chargeMontageAdministratif||"Non sp\xe9cifi\xe9"]})]})]})]}),(0,r.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,r.jsxs)("span",{children:["D\xe9p\xf4t: ",W(e.delaiDepot)]}),(0,r.jsx)("span",{className:"mx-2",children:"•"}),(0,r.jsxs)("span",{children:["D\xe9pos\xe9e: ",e.offreDeposee?"Oui":"Non"]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsxs)("button",{onClick:()=>_(e),className:"text-blue-600 hover:text-blue-900 text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-eye-line mr-1"}),"Voir"]}),(0,r.jsxs)("button",{onClick:()=>F(e),className:"text-purple-600 hover:text-purple-900 text-sm font-medium",children:[(0,r.jsx)("i",{className:"ri-download-line mr-1"}),"TDR"]})]})]})})]},e.id))});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(c.A,{}),(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6",children:[(0,r.jsx)("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsxs)("div",{className:"flex items-center text-green-800",children:[(0,r.jsx)("i",{className:"ri-check-line mr-2 text-green-600"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:["Affichage des offres approuv\xe9es uniquement - ",o.length," en tant que p\xf4le lead, ",u.length," en tant que p\xf4le associ\xe9"]})]})}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-search-line mr-2"}),"Rechercher"]}),(0,r.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),placeholder:"Rechercher par titre, bailleur, pays...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-settings-3-line mr-2"}),"Modalit\xe9"]}),(0,r.jsxs)("select",{value:k,onChange:e=>C(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",children:[(0,r.jsx)("option",{value:"all",children:"Toutes les modalit\xe9s"}),(0,r.jsx)("option",{value:"nouveau",children:"Nouveau"}),(0,r.jsx)("option",{value:"mont\xe9e",children:"Mont\xe9e"}),(0,r.jsx)("option",{value:"d\xe9pos\xe9e",children:"D\xe9pos\xe9e"}),(0,r.jsx)("option",{value:"gagn\xe9",children:"Gagn\xe9"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-layout-line mr-2"}),"Vue"]}),(0,r.jsxs)("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>A("table"),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("table"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>A("cards"),className:"flex-1 flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("cards"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line mr-2"}),"Modalit\xe9s R\xe9partition"]}),(0,r.jsxs)("button",{onClick:()=>T(!O),className:"w-full px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2 ".concat(O?"bg-green-600 hover:bg-green-700 text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:[(0,r.jsx)("i",{className:"ri-file-list-3-line"}),O?"Masquer":"Afficher"]})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsxs)("button",{onClick:q,className:"w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center justify-center gap-2",children:[(0,r.jsx)("i",{className:"ri-refresh-line"}),"Actualiser"]})})]})]}),O&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-2xl p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-blue-900",children:[(0,r.jsx)("i",{className:"ri-file-list-3-line mr-2"}),"Modalit\xe9s de R\xe9partition - ",t]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>A("table"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("table"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>A("cards"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("cards"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]}),(0,r.jsxs)("p",{className:"text-blue-700 text-sm",children:["Affichage de toutes les modalit\xe9s renseign\xe9es dans le formulaire de gestion de r\xe9partition pour le ",t,"."]})]}),"table"===S?(0,r.jsx)(Z,{}):(0,r.jsx)($,{})]}),!O&&(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200 bg-blue-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-blue-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-star-line text-blue-600 mr-2"}),"Lead en montage"]}),(0,r.jsxs)("p",{className:"text-blue-700 mt-1",children:[H.length," offre",H.length>1?"s":""," o\xf9 ",t," est le p\xf4le lead"]})]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>A("table"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("table"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>A("cards"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("cards"===S?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:0===H.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune offre en tant que p\xf4le lead"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[t," n'a actuellement aucune offre approuv\xe9e o\xf9 il est le p\xf4le lead."]})]}):"table"===S?(0,r.jsx)(i,{offres:H,loading:h,poleName:t,onViewOffre:_,onDeleteOffre:V,onDownloadTDR:F,searchTerm:j,sortBy:N,sortOrder:w,onSort:P,selectedModalite:k}):(0,r.jsx)("div",{className:"grid gap-6",children:H.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-blue-200",children:[(0,r.jsx)(n.A,{offre:e,showActions:!0,onViewOffre:_,onDeleteOffre:V,onDownloadTDR:F,showPoleInfo:!1,showModalite:!0,showPriority:!0,showBudget:!0,showDate:!0,showStatus:!0,showTDR:!0,showDescription:!0,showDetails:!0,showCommentaire:!1}),(0,r.jsx)(Y,{offre:e})]},e.id))})})]}),{}),(0,r.jsx)(()=>(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-green-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200 bg-green-50",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-green-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-team-line text-green-600 mr-2"}),"Associ\xe9 en montage"]}),(0,r.jsxs)("p",{className:"text-green-700 mt-1",children:[Q.length," offre",Q.length>1?"s":""," o\xf9 ",t," est choisi comme p\xf4le associ\xe9"]})]}),(0,r.jsxs)("div",{className:"flex bg-white rounded-lg p-1",children:[(0,r.jsxs)("button",{onClick:()=>A("table"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("table"===S?"bg-green-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-table-line"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>A("cards"),className:"flex items-center justify-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 ".concat("cards"===S?"bg-green-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,r.jsx)("i",{className:"ri-grid-line"}),"Cartes"]})]})]})}),(0,r.jsx)("div",{className:"p-6",children:0===Q.length?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-green-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune offre en tant que p\xf4le associ\xe9"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600 mt-2",children:[t," n'a actuellement aucune offre approuv\xe9e o\xf9 il est choisi comme p\xf4le associ\xe9."]})]}):"table"===S?(0,r.jsx)(i,{offres:Q,loading:h,poleName:t,onViewOffre:_,onDeleteOffre:V,onDownloadTDR:F,searchTerm:j,sortBy:N,sortOrder:w,onSort:P,selectedModalite:k}):(0,r.jsx)("div",{className:"grid gap-6",children:Q.map(e=>(0,r.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4 border border-green-200",children:[(0,r.jsx)(n.A,{offre:e,showActions:!0,onViewOffre:_,onDeleteOffre:V,onDownloadTDR:F,showPoleInfo:!1,showModalite:!0,showPriority:!0,showBudget:!0,showDate:!0,showStatus:!0,showTDR:!0,showDescription:!0,showDetails:!0,showCommentaire:!1}),(0,r.jsx)(Y,{offre:e})]},e.id))})})]}),{})]}),O&&("table"===S?(0,r.jsx)(Z,{}):(0,r.jsx)($,{})),R&&M&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:"D\xe9tails de l'offre"}),(0,r.jsx)("button",{onClick:()=>{E(!1),L(null)},className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,r.jsx)("i",{className:"ri-close-line text-2xl"})})]})}),(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Informations principales"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Intitul\xe9 de l'offre"}),(0,r.jsx)("p",{className:"text-gray-900 font-medium",children:M.intituleOffre||M.titre||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Bailleur"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.bailleur||M.client||"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Pays"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.pays&&M.pays.length>0?M.pays.join(", "):"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Priorit\xe9"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.priorite||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Modalit\xe9"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.modalite||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600 mb-3 block",children:"Actions de modalit\xe9"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,r.jsxs)("button",{onClick:()=>{U(M),E(!1),L(null)},className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat("mont\xe9e"===M.modalite?"bg-green-100 text-green-800 border border-green-300":"bg-gray-100 text-gray-700 hover:bg-green-50 border border-gray-300"),children:[(0,r.jsx)("i",{className:"ri-check-line mr-1"}),"Marquer comme mont\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{z(M),E(!1),L(null)},className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat("d\xe9pos\xe9e"===M.modalite?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-gray-100 text-gray-700 hover:bg-yellow-50 border border-gray-300"),children:[(0,r.jsx)("i",{className:"ri-send-plane-line mr-1"}),"Marquer comme d\xe9pos\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{J(M),E(!1),L(null)},className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat("gagn\xe9"===M.modalite?"bg-purple-100 text-purple-800 border border-purple-300":"bg-gray-100 text-gray-700 hover:bg-purple-50 border border-gray-300"),children:[(0,r.jsx)("i",{className:"ri-trophy-line mr-1"}),"Marquer comme gagn\xe9e"]}),(0,r.jsxs)("button",{onClick:()=>{V(M),E(!1),L(null)},className:"px-3 py-2 text-sm font-medium rounded-lg transition-colors ".concat("annul\xe9e"===M.modalite?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-700 hover:bg-red-50 border border-gray-300"),children:[(0,r.jsx)("i",{className:"ri-close-line mr-1"}),"Annuler l'offre"]})]})]}),(0,r.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:(0,r.jsx)(d,{offreId:M.id,onFichiersUpdate:()=>{q()}})})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Informations suppl\xe9mentaires"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Date de d\xe9p\xf4t"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.dateDepot?new Date(M.dateDepot).toLocaleDateString("fr-FR"):"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Montant"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.montant&&M.devise?"".concat(M.montant," ").concat(M.devise):"Non sp\xe9cifi\xe9"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Dur\xe9e de mission"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.dureeMission||"Non sp\xe9cifi\xe9e"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-sm font-medium text-gray-600",children:"Objectifs"}),(0,r.jsx)("p",{className:"text-gray-900",children:M.objectifs||"Non sp\xe9cifi\xe9s"})]})]})]})]}),M.commentaire&&(0,r.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Commentaires"}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:M.commentaire})]})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[255,458,530,144,347,870,358],()=>t(13316)),_N_E=e.O()}]);