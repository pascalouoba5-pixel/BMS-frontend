(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[317],{10113:(e,t,s)=>{Promise.resolve().then(s.bind(s,40530))},40530:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(73365),a=s(59534),l=s.n(a),i=s(1521),n=s(31956),d=s(150),o=s(98809),c=s(84857);function x(){return(0,r.jsx)(n.cj,{children:(0,r.jsx)(c.default,{children:(0,r.jsx)(u,{})})})}function u(){let[e,t]=(0,i.useState)([]),[s,a]=(0,i.useState)(null),[n,c]=(0,i.useState)(!1),[x,u]=(0,i.useState)(null),[m,p]=(0,i.useState)(""),[h,g]=(0,i.useState)("all"),[b,f]=(0,i.useState)(!1),[j,v]=(0,i.useState)(!1),[N,y]=(0,i.useState)(!1),[w,S]=(0,i.useState)(null),[k,O]=(0,i.useState)(""),[C,V]=(0,i.useState)("en_attente"),[A,I]=(0,i.useState)(""),[_,D]=(0,i.useState)("table");(0,i.useEffect)(()=>{f(!0)},[]),(0,i.useEffect)(()=>{if(b){E();let e=setInterval(E,3e4),t=e=>{"offres"===e.key&&E()};return window.addEventListener("storage",t),()=>{clearInterval(e),window.removeEventListener("storage",t)}}},[b]);let E=()=>{if(b){v(!0);try{let e=JSON.parse(localStorage.getItem("offres")||"[]"),s=new Date().toISOString().slice(0,10),r=e.filter(e=>R(e,s));t(r)}catch(e){console.error("Erreur lors du chargement des offres:",e)}finally{v(!1)}}},R=(e,t)=>{if(e.dateSoumissionValidation)try{return new Date(e.dateSoumissionValidation).toISOString().slice(0,10)===t}catch(e){console.error("Erreur lors du parsing de la date:",e)}return!1},q=e=>{S(e),O(e.commentaireValidation||""),V(e.statut||"en_attente"),I(e.priorite||""),y(!0)},z=e=>{switch(e){case"Offre strat\xe9gique":return"bg-purple-100 text-purple-800 border-purple-200";case"Offre classique":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},P=e=>{switch(e){case"approuv\xe9e":return"bg-green-100 text-green-800 border-green-200";case"rejet\xe9e":return"bg-red-100 text-red-800 border-red-200";case"en_attente":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},J=e=>{switch(e){case"approuv\xe9e":return"ri-check-line";case"rejet\xe9e":return"ri-close-line";default:return"ri-time-line"}},L=e=>{try{return new Date(e).toLocaleDateString("fr-FR")}catch(e){return"Date invalide"}},M=[...e].sort((e,t)=>{let s=e.dateSoumissionValidation?new Date(e.dateSoumissionValidation).getTime():0;return(t.dateSoumissionValidation?new Date(t.dateSoumissionValidation).getTime():0)-s}).filter(e=>"all"===h||e.statut===h);return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-white",children:[(0,r.jsx)(o.A,{}),(0,r.jsx)("nav",{className:"bg-white/90 backdrop-blur-sm border-b border-blue-100 sticky top-0 z-50",children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)(d.default,{}),(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Validation des Offres"})]}),(0,r.jsx)("div",{className:"flex items-center space-x-4",children:(0,r.jsx)(l(),{href:"/dashboard",className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold transition-colors",children:"Dashboard"})})]})})}),(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6 mb-6",children:(0,r.jsxs)("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-4 items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filtrer par statut"}),(0,r.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,r.jsx)("option",{value:"all",children:"Tous les statuts"}),(0,r.jsx)("option",{value:"en_attente",children:"En attente"}),(0,r.jsx)("option",{value:"approuv\xe9e",children:"Approuv\xe9es"}),(0,r.jsx)("option",{value:"rejet\xe9e",children:"Rejet\xe9es"})]})]})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Vue :"}),(0,r.jsxs)("button",{onClick:()=>D("table"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("table"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,r.jsx)("i",{className:"ri-table-line mr-2"}),"Tableau"]}),(0,r.jsxs)("button",{onClick:()=>D("cards"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors ".concat("cards"===_?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[(0,r.jsx)("i",{className:"ri-grid-line mr-2"}),"Cartes"]})]})]})}),j?(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-8 text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Chargement des offres..."})]}):"table"===_?(0,r.jsx)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:0===M.length?(0,r.jsxs)("div",{className:"p-8 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Aucune offre \xe0 valider"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Il n'y a actuellement aucune offre soumise pour validation aujourd'hui."})]}):(0,r.jsx)("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full",children:[(0,r.jsx)("thead",{className:"bg-blue-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider",children:"Offre"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider",children:"Bailleur"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider",children:"Date de soumission"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider",children:"Statut"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-blue-700 uppercase tracking-wider",children:"Actions"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(e=>{var t;return(0,r.jsxs)("tr",{className:"hover:bg-blue-50 transition-colors",children:[(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.intituleOffre}),(0,r.jsx)("div",{className:"text-sm text-gray-500",children:(null==(t=e.pays)?void 0:t.join(", "))||"Pays non sp\xe9cifi\xe9s"})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:e.bailleur})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"text-sm text-gray-900",children:L(e.dateSoumissionValidation)})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border ".concat(P(e.statut||"en_attente")),children:[(0,r.jsx)("i",{className:"".concat(J(e.statut||"en_attente")," mr-1")}),"approuv\xe9e"===e.statut?"Approuv\xe9e":"rejet\xe9e"===e.statut?"Rejet\xe9e":"En attente"]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>{a(e),u("approve"),c(!0)},className:"bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-xs transition-colors",disabled:"approuv\xe9e"===e.statut,children:"Approuver"}),(0,r.jsx)("button",{onClick:()=>{a(e),u("reject"),c(!0)},className:"bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded text-xs transition-colors",disabled:"rejet\xe9e"===e.statut,children:"Rejeter"}),(0,r.jsx)("button",{onClick:()=>q(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-xs transition-colors",children:"Modifier"})]})})]},e.id)})})]})})}):(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 overflow-hidden",children:[(0,r.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,r.jsx)("i",{className:"ri-check-line text-blue-600 mr-2"}),"Validation des Offres"]}),(0,r.jsxs)("p",{className:"text-gray-600 mt-1",children:[M.length," offre",M.length>1?"s":""," \xe0 valider"]})]})})}),(0,r.jsx)("div",{className:"p-6",children:j?(0,r.jsx)("div",{className:"animate-pulse",children:(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,t)=>(0,r.jsxs)("div",{className:"bg-gray-100 rounded-2xl p-6",children:[(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-4"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),(0,r.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"})]})]},t))})}):(0,r.jsx)(()=>(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:0===M.length?(0,r.jsxs)("div",{className:"col-span-full bg-white rounded-2xl shadow-lg border border-blue-100 p-12 text-center",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-inbox-line text-2xl text-blue-600"})}),(0,r.jsx)("p",{className:"text-lg font-medium text-gray-900",children:"Aucune offre \xe0 valider"}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"Il n'y a actuellement aucune offre soumise pour validation aujourd'hui."})]}):M.map(e=>{var t;return(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-blue-100 p-6 hover:shadow-xl transition-all duration-300 hover:-translate-y-1",children:[(0,r.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-2 line-clamp-2",children:e.intituleOffre}),e.statut&&(0,r.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border ".concat(P(e.statut)),children:[(0,r.jsx)("i",{className:"".concat(J(e.statut)," mr-1")}),"approuv\xe9e"===e.statut?"Approuv\xe9e":"rejet\xe9e"===e.statut?"Rejet\xe9e":"En attente"]})]})}),(0,r.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bailleur"}),(0,r.jsx)("p",{className:"text-sm text-gray-900 font-medium",children:e.bailleur})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pays"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:(null==(t=e.pays)?void 0:t.join(", "))||"Pays non sp\xe9cifi\xe9s"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date de soumission"}),(0,r.jsx)("p",{className:"text-sm text-gray-900",children:L(e.dateSoumissionValidation)})]}),e.priorite&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priorit\xe9"}),(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full border ".concat(z(e.priorite)),children:e.priorite})]})]}),(0,r.jsxs)("div",{className:"flex gap-2 pt-4 border-t border-gray-100",children:[(0,r.jsxs)("button",{onClick:()=>{a(e),u("approve"),c(!0)},className:"flex-1 bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1",disabled:"approuv\xe9e"===e.statut,children:[(0,r.jsx)("i",{className:"ri-check-line"}),"Approuver"]}),(0,r.jsxs)("button",{onClick:()=>{a(e),u("reject"),c(!0)},className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1",disabled:"rejet\xe9e"===e.statut,children:[(0,r.jsx)("i",{className:"ri-close-line"}),"Rejeter"]}),(0,r.jsxs)("button",{onClick:()=>q(e),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center justify-center gap-1",children:[(0,r.jsx)("i",{className:"ri-edit-line"}),"Modifier"]})]})]},e.id)})}),{})})]})]}),n&&s&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-check-line text-2xl text-blue-600"})}),(0,r.jsxs)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:["approve"===x?"Approuver":"Rejeter"," l'offre"]}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:s.intituleOffre}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"approve"===x?"Cette offre sera marqu\xe9e comme approuv\xe9e et pourra \xeatre trait\xe9e.":"Cette offre sera marqu\xe9e comme rejet\xe9e."})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaire (optionnel)"}),(0,r.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),maxLength:500,rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Ajoutez un commentaire..."}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[m.length,"/500 caract\xe8res"]})]})}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{if(!s||!x)return;let r=e.map(e=>e.id===s.id?{...e,statut:"approve"===x?"approuv\xe9e":"rejet\xe9e",commentaireValidation:m,dateValidation:new Date().toISOString()}:e),l=JSON.parse(localStorage.getItem("offres")||"[]").map(e=>e.id===s.id?{...e,statut:"approve"===x?"approuv\xe9e":"rejet\xe9e",commentaireValidation:m,dateValidation:new Date().toISOString()}:e);localStorage.setItem("offres",JSON.stringify(l)),t(r),c(!1),a(null),p(""),u(null)},className:"flex-1 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap ".concat("approve"===x?"bg-green-600 hover:bg-green-700 text-white":"bg-red-600 hover:bg-red-700 text-white"),children:"approve"===x?"Approuver":"Rejeter"}),(0,r.jsx)("button",{onClick:()=>{c(!1),a(null),p(""),u(null)},className:"flex-1 border-2 border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap",children:"Annuler"})]})]})}),N&&w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-edit-line text-2xl text-blue-600"})}),(0,r.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Modifier l'avis"}),(0,r.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:w.intituleOffre}),(0,r.jsx)("p",{className:"text-gray-600 text-sm",children:"Modifiez le statut, le commentaire et la priorit\xe9 de cette offre"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut"}),(0,r.jsxs)("select",{value:C,onChange:e=>V(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[(0,r.jsx)("option",{value:"en_attente",children:"En attente"}),(0,r.jsx)("option",{value:"approuv\xe9e",children:"Approuv\xe9e"}),(0,r.jsx)("option",{value:"rejet\xe9e",children:"Rejet\xe9e"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commentaire (optionnel)"}),(0,r.jsx)("textarea",{value:k,onChange:e=>O(e.target.value),maxLength:500,rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Ajoutez un commentaire..."}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:[k.length,"/500 caract\xe8res"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorit\xe9 (optionnel)"}),(0,r.jsxs)("select",{value:A,onChange:e=>I(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",children:[(0,r.jsx)("option",{value:"",children:"Aucune priorit\xe9"}),(0,r.jsx)("option",{value:"Offre strat\xe9gique",children:"Offre strat\xe9gique"}),(0,r.jsx)("option",{value:"Offre classique",children:"Offre classique"})]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6",children:[(0,r.jsx)("button",{onClick:()=>{if(!w)return;let s=e.map(e=>e.id===w.id?{...e,statut:C,commentaireValidation:k,priorite:A,dateValidation:new Date().toISOString()}:e),r=JSON.parse(localStorage.getItem("offres")||"[]").map(e=>e.id===w.id?{...e,statut:C,commentaireValidation:k,priorite:A,dateValidation:new Date().toISOString()}:e);localStorage.setItem("offres",JSON.stringify(r)),t(s),y(!1),S(null),O(""),V("en_attente"),I("")},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap",children:"Sauvegarder"}),(0,r.jsx)("button",{onClick:()=>{y(!1),S(null),O(""),V("en_attente"),I("")},className:"flex-1 border-2 border-gray-300 hover:bg-gray-50 text-gray-700 px-4 py-3 rounded-lg font-medium transition-colors cursor-pointer whitespace-nowrap",children:"Annuler"})]})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[255,458,441,347,870,358],()=>t(10113)),_N_E=e.O()}]);